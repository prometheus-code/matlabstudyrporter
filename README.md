# matlab

### 强制关闭当前程序(万能保险)

Ctrl+c

## 常见函数

1. format
2. 三角函数
   - 直接sin和cos是对应弧度制
   - sind和cosd才是对应角度
3. exp函数是e^x
4. abs求绝对值
5. 取整函数
   - round 四舍五入
   - ceil 向上取整
   - floor 向下取整
   - fix 向零取整
6. rem取余数
7. isprime判断素数
8. find找对应序号
9. who命令和whos命令
10. save和load命令
    - save mydata a x
      11.inv矩阵求逆

11.str2double() %str to double

12. num2cell()把矩阵每个元素转成cell的元素，每个数独立
13. complex(x,y)构建复型变量
14. all(i):若向量i中所有元素非零，结果为1，否则结果为0。

## 预定义变量

1. ans默认赋值变量
2. i和j代表虚数单位
3. pi表示圆周率
4. NaN表示非数





## 矩阵

### 矩阵的表示

A=[1,2,3;4,5,6;7,8,9]
或
A=[1 2 3;4 5 6;7 8 9]

### 冒号表达式

e1:e2:e3
或
linspace(a,b,n)#a表示第一个元素，b表示最后个元素，n表示元素总数 

### 结构矩阵和单元矩阵

相当于python里的字典

### 矩阵元素的引用

- 没什么重要的
  就sub2ind和ind2sub
  sub2inb(size(A),[1,2;2,2],[1,1;3,2])
  A(1,1)  A(2,1)
  A(2,3)  A(2,2)
  ind2sub([3,3],[1,3,5])
- 冒号表达式也可以取子矩阵
  A(i,:)
  A(:,J)
  A(i:i+m,k:k+m)
  A(i:i+m,:)
  end表示最后元素下标
- 直接空矩阵
  A=[]
- reshape改变行数和列数
- B=A(:)

### 基本运算

- 算术运算
  点运算比较好用，对应元素做运算
- 关系运算符
  注意下不等于,是~=
  不是这个!=
- 逻辑运算&|~

### 字符串处理

- a的序号比A大
- length算长度
- eval()跟python里一样的算字符表达式
- strcmp(s1,s2)   用来比较字符串s1和s2是否相等，如果相等，返回结果为1，否则
  返回0。
- strncmp(s1,s2,n)   用来比较两个字符串前n个字符是否相等，如果相等，返回1，
  否则返回0。
- strcmpi(s1,s2)   在忽略字母大小写前提下，比较字符串s1和s2是否相等，如果相
  等，返回1，否则返回0。
- strncmpi(s1,s2)    在忽略字符串大小写前提下，比较两个字符串前n个字符是否
  相等，如果相等，返回1，否则返回0。
- trncmpi(s1,s2)
- findstr(s1,s2)
- strrep(s1,s2,s3)用s3替换s1中s2
- lower()小写化
- upper()大写化

### 特殊矩阵

```
	以下没特殊注释的函数全直接带阶数
```



- zeros()函数，全0矩阵

- ones()函数，全1矩阵

- eye()函数，对角线为1的矩阵

- rand()函数, (0,1)随机矩阵

- randn()函数,产生均值为0,方差为1的标准正态分布随机矩阵

  - magic()魔方矩阵

  - vander(v)范得蒙矩阵

    - 以向量v为基础的范得蒙矩阵

    - 例如

      > v=1:5
      >
      > A=vander(v)

  - hilb()希尔伯特矩阵

    - 可以用以下命令

      > format rat

      来确定为有理数

  - compan()伴随矩阵

    > p=[1,-2,-5,6]
    >
    > A=compan(p)

  - pascal()矩阵

### 矩阵变换

```
以下的k为第几条对角线(主对角线往上为1，2，3，往下为-1，-2，-3)
没填k则k默认为0，取主对角线
```

- 对角阵

  - 对角阵

  - 数量矩阵:对角线上的元素相等的对角矩阵

  - 单位矩阵:对角线上元素全为1的对角矩阵

    - 函数为diag(A,k)

    - 有则提取，没则制造

    - 有矩阵的话，A为矩阵

    - 一般k默认为0

    - 没有矩阵的话，A为向量

      ```
      题目：建立矩阵A，然后A的第一行元素乘以1，第二行程以2，...
      解法提示:用一个对角阵左乘一个矩阵时，相当于用对角阵对角线对应的第几个元素乘对接的矩阵的对应的第几行，全乘完为止。
      左行右列
      ```

- 三角阵

  - 上三角

    - 取矩阵对角线上元素

    > triu(A,k)

  - 下三角

    - 取对角线下元素

  > tril(A,k)

- 矩阵的转置

  - 转置为在矩阵后加(.')
  - 共轭转置为加(')

  > A.'  %转置
  >
  > A'   %共轭转置

- 矩阵的旋转

  - rot90(A,n):将矩阵A逆时针方向旋转90度的n倍，当n=1时可省略

- 矩阵的翻转

  - 对矩阵左右翻转是将矩阵的第一列和最后一列调换，第二列和倒数第二列调换,...,依此类推。

    > fliplr(A) %对矩阵A左右翻转
    >
    > flipud(A) %对矩阵A上下翻转

  - 用途:取副对角线元素

- 矩阵的求逆

  - inv(A)求A的逆矩阵
  - 解线性方程组

### 矩阵求值

- det(A):求方阵A所对应的行列式的值

- rank(A):求矩阵A的秩

- trace(A):求矩阵A的迹

  - 矩阵的迹等于矩阵的对角线元素之和，也等于矩阵的特征值之和

- 向量和矩阵的范数

  - 矩阵或向量的范数用来度量矩阵或向量在某种意义下的长度
  - 向量1-范数:向量元素的绝对值之和
  - 向量2-范数:向量元素绝对值的平方和的平方根
  - 向量∞-范数:所有向量元素绝对值中的最大值
  - 计算范数的函数如下

  > norm(v,n) %一般n不填时默认为2，即默认计算向量v的2-范数
  >
  > %当n=1时，计算向量v的1-范数
  >
  > %当n=inf时，计算向量v的∞-范数

- 矩阵的条件数

  - 矩阵A的条件数等于A的范数与A的逆矩阵的范数的乘积
  - 条件数越接近于1，矩阵的性能越好，反之，矩阵的性能越差

  > cond(A,n)%一般n不填时默认为2，即默认计算向量v的2-条件数
  >
  > %当n=1时，计算向量v的1-条件数
  >
  > %当n=inf时，计算向量v的∞-条件数

### 矩阵的特征值

E=eig(A),求矩阵A的全部特征值，构成向量E

[X,D]=eig(A):求矩阵A的全部特征值，构成对角阵D，并产生矩阵X，x各列是相应的特征向量

### 稀疏矩阵

- 矩阵的存储方式(太长了，也就是记录0和不记录0的区别)

- 稀疏存储方式的产生

  - 完全存储方式与稀疏存储方式之间的转化

    - A=sparse(S):将矩阵S转化为稀疏存储方式的矩阵A.
    - S=full(A):将矩阵A转化为完全存储方式的矩阵S

  - 直接建立稀疏存储矩阵

    - sparse(m,n):生成一个mXn的所有元素都是零的稀疏矩阵
    - sparse(u,v,S):其中u,v,S是3个等长的向量。S是要建立的稀疏存储矩阵的非零元素，u(i)，v(i)分别是S(i)的行和列下标。

    ```
    >> A=sparse([1,3,3],[2,1,4],[4,5,-7])
    
    A =
    
       (3,1)        5
       (1,2)        4
       (3,4)       -7
    
    >> B=full(A)
    
    B =
    
         0     4     0     0
         0     0     0     0
         5     0     0    -7
    
    >> 
    ```

    

    - spconvert() 懒得解释了，看下面就行了

    ```
    >> A=[3 1 2;3 2 1;3 3 3]
    
    A =
    
         3     1     2
         3     2     1
         3     3     3
    
    >> B=spconvert(A)
    
    B =
    
       (3,1)        2
       (3,2)        1
       (3,3)        3
    
    >> A=full(B)
    
    A =
    
         0     0     0
         0     0     0
         2     1     3
    
    >> 
    ```

- 带状稀疏矩阵的稀疏储存

  - 带状稀疏矩阵是指非零元素集中在对角线上的矩阵

  - 函数spdiag()

    - [B,d]=spdiag(A) %B对角线变量，d对角线位置
    - A=spdiags(B,d,m,n) %B,d同上，mXn大小的矩阵

    ```
    >> A=[11 0 0;12 1 3;13 2 3]
    
    A =
    
        11     0     0
        12     1     3
        13     2     3
    
    >> [B,d]=spdiags(A)
    
    B =
    
        13    12    11     0
         0     2     1     0
         0     0     3     3
    
    
    d =
    
        -2
        -1
         0
         1
    
    >> spdiags(B,d,3,3)
    
    ans =
    
       (1,1)       11
       (2,1)       12
       (3,1)       13
       (2,2)        1
       (3,2)        2
       (2,3)        3
       (3,3)        3
    
    >> full(spdiags(B,d,3,3))
    
    ans =
    
        11     0     0
        12     1     3
        13     2     3
    
    >> 
    ```

## 结构与程序

### 顺序结构程序

1. 程序的基本步骤:略

2. 创建文件命令

   > edit file

3. 输入命令

   > input()

4. 输出命令

   > disp()

5. 暂停命令

   > pause()

### 选择结构

#### if

```
if 0==1 
    y=sqrt(3);
    x=y;
elseif 1==1
    x='error';
end
disp(x)
```

#### switch

```
g=input('PM2.5')
switch fix(g)
    case num2cell(0:34)%num2cell把矩阵每个元素转成cell的元素，每个数独立
        disp('niubi');
    case num2cell(35:74)
        disp('sb');
end
```

### 循环结构

#### for

```
y=0; 
g=-1; 
n=input('n=?'); 
for i=1:n 
 g=-g; 
 y=y+g/(2*i-1); 
end 
pai=4*y
```

如果需要效率，推荐向量求和:

原因:减少循环次数

```
n=input('n=?'); 
x=1:2:(2*n-1); 
y=(-1).^(2:n+1)./x; 
pai=sum(y)*4
```

例题：计算pi/4   

```
a=0; 
b=1; 
n=input('n=?'); 
h=(b-a)/n; 
x=a:h:b; 
f=sqrt(1-x.*x); 
s=[]; 
for k=1:n 
 s1=(f(k)+f(k+1))*h/2; 
 s=[s,s1]; 
end 
pai=4*sum(s)
```

#### while

例题:从键盘输入若干个数，当输入0时结束输入，求这些数的平均值和
它们之和。

```
msum=0; 
n=0; 
x=input('Enter a number (end in 0):'); 
while x~=0 
 msum=msum+x; 
 n=n+1; 
 x=input('Enter a number (end in 0):'); 
end 
if n>0 
 msum 
 mean=msum/n 
end
```

- break和continue的用法与其他语言用法一样

### 函数文件

- 通常:调用格式： [输出实参表]=函数名(输入实参表)

- 匿名函数:用法与python类似

  - 格式为 函数句柄变量=@(匿名函数输入参数) 匿名函数表达式

  如

  > f=@(x,y) x^2+y^2

- 嵌套和递归与其他语言类似

- 函数参数与变量的作用域与其他语言类似

  - 全局变量都是global

## 绘图

### 二维曲线

**选项**

- 线型
  - “-” ：实线
  - “:” ：虚线
  - “-.”：点划线
  - “--”：双划线
- 颜色
  - “r” ：红色
  - “g” ：绿色
  - “b” ：蓝色
  - “w”：白色
  - “k” ：黑色
- 数据点标记
  - “*”：星号
  - “o”：圆圈
  - “s”：方块
  - “p”：五角星
  - “^”：朝上三角符号

**函数**

- plot函数标准格式**plot(x, y)** 

  - 当x和y全是向量时

    - 其中，x和y分别用于存储x坐标和y坐标数据。通常，x和y为长
      度相同的向量。

      ```
      x=[2.5, 3.5, 4, 5];
      
      y=[1.5, 2.0, 1, 1.5];
      
      plot(x, y)
      ```

      

  - 当只有x，且x为复数向量

    ```
    x=[2.5, 3.5, 4, 5];
    y=[1.5, 2, 1, 1.5];
    cx=x+y*i;    %或者cx = complex(x,y);
    
    plot(cx)
    ```

    

  - 当x是向量，y是矩阵时

    - **如果矩阵y的列数等于x的长度，则以向量x为横坐标，以y的每个
      行向量为纵坐标绘制曲线，曲线的条数等于y的行数**
    - 如果矩阵y的行数等于x的长度，则以向量x为横坐标，以y的每个
      列向量为纵坐标绘制曲线，曲线的条数等于y的列数

  列数相等时：

  ```
  x= linspace(0,2*pi,100);
  y= [sin(x); sin(2*x); sin(0.5*x)];
  plot(x,y)
  ```

  

  行数相等时：

  ```
  x= linspace(0,2*pi,100);
  y= [sin(x); sin(2*x); sin(0.5*x)];
  
  y=y.';
  
  plot(x,y)
  ```

  

- fplot函数

  - fplot函数的基本用法
    fplot(f ,lims, 选项 )

  - 其中，f代表一个函数，通常采用函数句柄的形式。lims为x轴的
    取值范围，用二元向量[xmin，xmax]描述，默认值为[-5, 5]。选项定
    义与plot函数相同。

    ```
    fplot(@(x) sin(1./x),[0,0.2], 'b')
    ```

    

  - 双输入函数参数的用法

    fplot(funx, funy, tlims, 选项)
    其中，funx、funy代表函数，通常采用函数句柄的形式。tlims为
    参数函数funx和funy的自变量的取值范围，用二元向量[tmin，tmax]
    描述

### 绘图辅助函数

- 图形注释

  - title()

    - 可以直接加字符串

      ```
      title('y=sin(x)')
      
      ```

    title({'MATLAB', 'y=sin(x)'})

    ```
      
    
    - 在图形标题中使用LaTeX格式控制符，但受LaTeX格式控制的部分要用大括号括起来。
    
    ```

      title('{\bf y=cos{\omega}t + {\beta}}')

    ```
      
    
     - 格式控制符
       “\bf”：加粗
       “\it”：斜体
       “\rm”：正体
    
     - Color属性 ：用于设置图形标题文本的颜色。
    
       > title('y=cos{\omega}t', 'Color','r')
    
     - FontSize属性 ：用于设置标题文字的字号。
    
    ```

       title('y=cos{\omega}t','FontSize',24)

    ```
    
    ```

  - xlabel

    ```
    xlabel('-2\pi \leq x \leq 2\pi')
    ```

    

  - ylabel

    ```
    ylabel('-2\pi \leq y \leq 2\pi')
    ```

    

  - text

    - 在前面的图形中添加文字说明。

    ```
    text(-2*pi, 0, '-2{\pi}')
    
    text(3, 0.28, '\leftarrow sin(x)')
    
    text(2.5, sin(2.5), 'sin(x)'); 
    text(1.5, sin(2*1.5), 'sin(2x)');
    text(5.5, sin(0.5*5.5), 'sin(0.5x)');
    ```

  - legend

    - 用图例标注曲线

      ```
      x = linspace(0, 2*pi, 100);
      
       plot(x, [sin(x); sin(2*x); sin(3*x)])
      
      legend('sin(x)', 'sin(2x)', 'sin(3x)')
      ```

- 坐标控制

  - axis函数

    - axis基本用法

    ```
    axis([xmin,xmax,ymin,ymax,zmin,zmax])
    ```

    - axis的其他用法

      - axis equal：纵、横坐标轴采用等长刻度

      - axis square：产生正方形坐标系(默认为矩形)

      - axis auto：使用默认设置

      - axis off：取消坐标轴

      - axis on：显示坐标轴

        ```
        x = [0, 1, 1, 0, 0];
        y = [0, 0, 1, 1, 0];
        plot(x,y)
        axis([-0.1, 1.1, -0.1, 1.1])
        axis equal;
        ```

  - 给坐标系加网格、边框

    - **！！！**注意grid和box一定要和图像在同一个代码块里

      > grid on
      > grid off
      > grid

      > box on
      > box off
      > box

- 图形保持

  - **！！！**注意hold一定要和图像在同一个代码块里
  - hold on
    hold off
    hold

  ```
  t = linspace(0,2*pi,100);
  x = sin(t); y = cos(t);
  plot(x, y, 'b')
  hold on; 
  plot(2*x, 2*y, 'r--')
  grid on
  axis([-2.2 2.2 -2.2 2.2])
  axis equal
  ```

- 图形窗口的分割

  - subplot函数
    - subplot(m, n, p)
    - 其中，m和n指定将图形窗口分成m×n个绘图区，p指定当前活动区。

  ```
  x=linspace(0,2*pi,60);
  subplot(1,2,1) 
  plot(x,sin(x)-1);
  title('sin(x)-1');axis ([0,2*pi,-2,0])
  subplot(1,2,2) 
  plot(x,cos(x)+1);
  title('cos(x)+1');axis ([0,2*pi,0,2])
  ```

  

### 其他形式的二维曲线

- 对数坐标图

  - semilogx(x1, y1, 选项1, x2, y2, 选项2, …)
    semilogy(x1, y1, 选项1, x2, y2, 选项2, …)
    loglog(x1, y1, 选项1, x2, y2, 选项2, …)
    其中，semilogx函数x轴为常用对数刻度，y轴为线性刻度；
    semilogy函数x轴为线性刻度，y轴为常用对数刻度；loglog函 数x轴和y轴均采用常用对数刻度

  ```
  x=0:0.1:10;
  y=1./x;
  subplot(2,2,1)
  plot(x,y) 
  title('plot(x,y)');grid on
  subplot(2,2,2)
  semilogx(x,y) 
  title('semilogx(x,y)');grid on
  subplot(2,2,3)
  semilogy(x,y) 
  title('semilogy(x,y)');grid on
  subplot(2,2,4)
  loglog(x,y) 
  title('loglog(x,y)');grid on
  ```

- 极坐标图

  - polar(theta, rho, 选项)

    其中，theta为极角，rho为极径，选项的内容与plot函数相同。

- 统计图

  - 条形图

  > 选项style:
  >
  > “grouped”：簇状分组
  > “stacked”： 堆积分组

    - - bar函数：绘制垂直条形图。其中，x存储横坐标，y存储数据，y的行数必须与向量x的长度相同。选项style用于指定分组排列模式。

  > bar(x, y,style)

  - - barh函数：绘制水平条形图。

      用法同上。


  ~~~
  y=[1,2,3,4,5; 1,2,1,2,1; 5,4,3,2,1];
  subplot(1,2,1)
  bar(y)
  title('Group')
  subplot(1,2,2)
  bar(y, 'stacked')
  title('Stack')
  ~~~

  ~~~
  x=[2015,2016,2017];
  y=[68,80,115,98,102;
  75,88,102,99,110;
  81,86,125,105,115];
  bar(x, y)
  title('Group');
  ~~~

  

  - 直方图

    - hist函数：绘制直角坐标系下的直方图

      - hist(y)

        hist(y, x)

      - 其中，y是要统计的数据，x用于指定区间的划分方式。若x是标
        量，则统计区间均分成x个小区间；若x是向量，则向量x中的每一个
        数指定分组中心值，元素的个数为数据分组数。x缺省时，默认按10
        个等分区间进行统计。

      ~~~
      y=randn(500,1);
      subplot(2,1,1); 
      hist(y); 
      title('高斯分布直方图');
      subplot(2,1,2); 
      x=-3:0.2:3;
      hist(y,x); 
      title('指定区间中心点的直方图')')
      ~~~

      

    - rose函数：绘制极坐标系下的直方图

      - rose(theta[,x])

      - 其中，参数theta用于确定每一区间与原点的角度，选项x用于指
        定区间的划分方式。

        ~~~
        y=randn(500,1);
        theta=y*pi;
        rose(theta)
        title('在极坐标下的直方图')
        ~~~

  - 面积类图形

    - pie函数

      pie(x, explode)

      其中，参数x存储待统计数据，选项explode控制图块的显示模式。

      ~~~
      score = [5, 17, 23, 9, 4];
      ex = [0,0,0,0,1];
      pie(score, ex) 
      legend('优秀', '良好', '中等’, '及格', …
      '不及格', 'location', 'eastoutside')%'location'用于指定图例位置，  %'eastoutside'表示图例放在绘图区域右边的外侧。
      ~~~

  - 散点类图形

    - scatter函数：散点图

      - scatter(x, y, 选项, 'filled')

      - 其中，x、y用于定位数据点，选项用于指定线型、颜色、数据
        点标记。如果数据点标记是封闭图形，可以用选项‘filled’指定
        填充数据点标记。该选项省略时，数据点是空心的。

        ~~~
        t = 0:pi/50:2*pi;
        x = 16*sin(t).^3;
        y = 13*cos(t)-5*cos(2*t)-2*cos(3*t)-cos(4*t);
        scatter(x,y,'rd','filled')
        ~~~

    - stairs函数： 阶梯图

    - stem函数： 杆图

  - 矢量类图形

    - compass函数：罗盘图

    - feather函数：羽毛图

    - quiver函数： 箭头图

      - quiver(x, y, u, v)

      - 其中，(x, y)指定矢量起点，(u, v)指定矢量终点。x、y、u、v
        是同样大小的向量或同型矩阵，若省略x、y，则在x-y平面上均匀取
        若干个点作为起点。

        ~~~
        A=[4,5]; B=[-10,0]; C=A+B;
        hold on;
        quiver(0, 0, A(1), A(2));
        quiver(0, 0, B(1), B(2));
        quiver(0, 0, C(1), C(2));
        text(A(1),A(2),'A');text(B(1),B(2),'B'); 
        text(C(1),C(2),'C'); 
        axis ([-12, 6, -1, 6])
        grid on
        ~~~

 

### 三维曲线

- plot3函数

  - plot3(x, y, z, 选项)
  - 参数X、Y、Z是同型矩阵时，以X、Y、Z对应列元素绘制曲线，
    曲线条数等于矩阵列数。
  - 参数X、Y、Z中有向量，也有矩阵时，向量的长度应与矩阵相符。

  ~~~
  t=0:0.01:2*pi;
  x=t;
  y=[sin(t); sin(t)+1; sin(t)+2; sin(t)+3; sin(t)+4];
  z=t;
  plot3(x,y,z)
  ~~~

  - 含多组输入参数的plot3函数

    plot3(x1, y1, z1, x2, y2, z2, …, xn, yn, zn)

    每一组x、y、z向量构成一组数据点的坐标，绘制一条曲线。

    ~~~
    t1=0:0.01:1.5*pi;
    t2=0:0.01:2*pi;
    t3=0:0.01:3*pi;
    plot3(t1,sin(t1),t1, t2,sin(t2)+1,t2, …
    t3,sin(t3)+2,t3)
    ~~~

    绘制空间曲线

    ~~~
    t=0:pi/50:6*pi;
    x=cos(t);
    y=sin(t);
    z=2*t;
    plot3(x,y,z,'p')
    xlabel('X'),ylabel('Y'),zlabel('Z');
    grid on
    ~~~

- fplot3函数

  - fplot3(funx, funy, funz, tlims)

  - 其中，funx、funy、funz代表定义曲线x、y、z坐标的函数，通
    常采用函数句柄的形式。tlims为参数函数自变量的取值范围，用二
    元向量[tmin, tmax]描述，默认为[-5, 5]。

  - 绘制墨西哥帽顶曲线

    ~~~
    xt = @(t) exp(-t/10).*sin(5*t);
    yt = @(t) exp(-t/10).*cos(5*t);
    zt = @(t) t;
    fplot3(xt, yt, zt, [-12, 12])
    ~~~

  - 用红色点划线绘制墨西哥帽顶曲线

    ~~~
    xt = @(t) exp(-t/10).*sin(5*t);
    yt = @(t) exp(-t/10).*cos(5*t);
    zt = @(t) t;
    fplot3(xt, yt, zt, [-12, 12], 'r-.')
    ~~~

### 三维曲面

- **！！！**一切前题是平面网格坐标矩阵，平面网格数据里包含网格点的坐标

  - 利用矩阵运算生成。

  ~~~
  x = 2:6;
  y = (3:8)';
  X = ones(size(y))*x;
  Y = y*ones(size(x));
  ~~~

  - **！！！**利用meshgrid函数生成。

    [X,Y]=meshgrid(x,y);

    其中，参数x、y为向量，存储网格点坐标的X、Y为矩阵。

  ~~~
  x = 2:1:6;
  y = (3:1:8)';
  [X, Y] = meshgrid(x, y);
  ~~~

  - **标准三维曲面**的平面网格数据
    - **球体的平面网格数据**
      - sphere函数
      - [x,y,z]=sphere(n)
        产生3个(n+1)阶的方阵，采用这3个矩阵可以绘制出圆心位于
        原点、半径为1的单位球体。
    - **柱体的平面网格数据**
    - cylinder函数
    - [x,y,z]=cylinder(R, n)
      其中，参数R是一个向量，存放柱面各个等间隔高度上的半径，
      n表示在圆柱圆周上有n个间隔点，默认有20个间隔点。

- 无处可放的peaks

  - 峰值函数
  - 其本质是二元高斯分布的概率密度函数。
  - 方便演示mesh和surf

  ~~~
  p1=peaks(10);
  p2=peaks;
  p3=peaks(-3:0.2:3);
  [x,y]=meshgrid(-2:0.1:2, 0:0.1:5);
  p4=peaks(x,y);
  ~~~

  

- 绘制三维曲面的函数

  - mesh函数和surf函数的调用格式：

  - mesh(x, y, z, c)

    surf(x, y, z, c)

    其中，x、y是网格坐标矩阵，z是网格点上的高度矩阵，c用于
    指定在不同高度下的曲面颜色。c省略时，颜色的设定正比于图形
    的高度。

  - mesh函数和surf函数的其他调用格式：
    mesh(z, c)
    surf(z, c)
    当x、y省略时，z矩阵的第2维下标当作x轴坐标，z矩阵的第1维下
    标当作y轴坐标。

  ~~~
  t = 1:5;
  z= [0.5*t; 2*t; 3*t];
  mesh(z);
  ~~~

  - 用cylinder函数绘制两个相互垂直且直径相等的圆柱面的
    相交图形。

    ~~~
    [x,y,z]= cylinder(1,60);
    z=[-1*z(2,:);z(2,:)];%之前的z的长度太短
    surf(x,y,z)
    hold on
    surf(y,z,x)
    axis equal
    ~~~

  - fmesh函数和fsurf函数

    - 和其他f开头的绘图函数一样直接连接匿名函数
    - 用于绘制参数方程定义的曲面
      fsurf(funx, funy, funz, uvlims) fmesh(funx, funy, funz, uvlims)
      其中，funx、funy、funz代表定义曲面x、y、z坐标的函数，通常
      采用函数句柄的形式。uvlims为funx、funy和funz的自变量的取值范围，
      用4元向量[umin, umax, vmin, vmax]描述 ，默认为[-5, 5, -5, 5]。

    ~~~
    funx = @(u,v) u.*sin(v);
    funy = @(u,v) -u.*cos(v);
    funz = @(u,v) v;
    fsurf(funx,funy,funz,[-5 5 -5 -2])
    hold on
    fmesh(funx,funy,funz,[-5 5 -2 2])
    hold off
    ~~~

### 图形修饰处理()

- 视点处理

  - 方位角：视点与原点连线在xy平面上
    的投影与y轴负方向形成的角度，正值
    表示逆时针，负值表示顺时针。

  - 仰角：视点与原点连线与xy平面的夹
    角，正值表示视点在xy平面上方，负
    值表示视点在xy平面下方

  - view函数的基本用法
    view(az,el)
    其中，az为方位角，el为仰角。系统默认的视点定义为
    方位角-37.5°，仰角30°。

    view函数的其他用法
    view(x,y,z)
    view(2)
    view(3)

    ~~~
    [x,y]=meshgrid(0:0.1:2, 1:0.1:3);
    z=(x-1).^2+(y-2).^2-1;
    subplot(2,2,1); mesh(x,y,z)
    title('方位角=-37.5{\circ},仰角=30{\circ}')
    subplot(2,2,2); mesh(x,y,z)
    view(0,90);title('方位角=0{\circ},仰角=90{\circ}')
    subplot(2,2,3); mesh(x,y,z)
    view(90,0); title('方位角=90{\circ},仰角=0{\circ}')
    subplot(2,2,4); mesh(x,y,z)
    view(-45,-60); title('方位角=-45{\circ},仰角=-60{\circ}')
    ~~~

- 色彩处理

  - 颜色的向量表示
    向量元素在[0，1]范围内取值，3个元素依次表示红、绿、蓝3种颜色的
    相对亮度，称为RGB三元组。

    - [0 0 1]：蓝色
      [1 0 0]：红色
      [0 1 0]：绿色
      [1 1 1]：白色
      [0 0 0]：黑色

  - 色图（Colormap）

    ~~~
    >> cmap = colormap(parula(5))
    cmap =
    	0.2081 0.1663 0.5292
    	0.0795 0.5159 0.8328
    	0.1986 0.7214 0.6310
    	0.8266 0.7320 0.3464
    	0.9763 0.9831 0.0538
    ~~~

    - 指定当前图形使用的色图

    - colormap cmapname
      colormap(cmap)

      ~~~
      >> surf(peaks)
      >> colormap hot
      ~~~

      创建一个灰色系列色图矩阵。

      ~~~
      c = [0, 0.2, 0.4, 0.6, 0.8, 1.0]';
      cmap = [c, c, c]; cmap=gray(6);
      surf(peaks)
      colormap(cmap)
      ~~~

  - 三维图形表面的着色

    - 可以用shading函数来改变着色方式。

      - shading faceted

        > 每个网格片用其高度
        > 对应的颜色进行着色，
        > 网格线是黑色。这是
        > 默认着色方式。

      - shading flat

        > 每个网格片用同一个
        > 颜色进行着色，且网
        > 格线也用相应的颜色。

      - shading interp

        > 网格片内采用颜色插
        > 值处理。

      ~~~
      [x,y,z]= cylinder(pi:-pi/5:0,10);
      colormap(lines);
      subplot(1,3,1);
      surf(x,y,z); shading flat
      subplot(1,3,2);
      surf(x,y,z); shading interp
      subplot(1,3,3);
      surf(x,y,z);
      ~~~

- 图形的裁剪处理

  - 将图形中需要裁剪部分对应的函数值设置成NaN，这样在绘制图
    形时，函数值为NaN的部分将不显示出来，从而达到对图形进行裁剪
    的目的。

  - 绘制3/4圆。

    ~~~
    t = linspace(0,2*pi,100);
    x = sin(t);
    y = cos(t);
    p = y > 0.5;
    y(p)= NaN;
    plot(x,y)
    axis([-1.1,1.1,-1.1,1.1])
    axis square
    grid on
    ~~~

  - 绘制3/4球面。

    ~~~
    [X, Y, Z] = sphere(60);
    p = Z>0.5;
    Z(p) = NaN;
    surf(X, Y, Z)
    axis([-1, 1, -1, 1, -1, 1])
    axis equal
    view(-45, 20)
    ~~~

### 交互式绘图工具(根本上否定你背绘图函数的一章)

- 自己找绘图
- plottools



## 数据分析与多项式计算

### 数据统计分析

> dim取1会返回行向量，取2会返回列向量



- 求矩阵的最大元素和最小元素
  - max():求向量或矩阵的最大元素
  - min():求向量或矩阵的最小元素
  - 下面以max()为例子讲用法
    - 当参数为向量时，上述函数有两种调用格式：
      （1）y=max(X)：返回向量X的最大值存入y，如果X中包含复数元素，
      则按模取最大值。
      （2）[y,k]=max(X)：返回向量X的最大值存入y，最大值元素的序号
      存入k，如果X中包含复数元素，则按模取最大值
    - 当参数为矩阵时，函数有三种调用格式：
      （1）max(A)：返回一个行向量，向量的第i个元素是矩阵A的第i列上的最
      大值。
      （2）[Y,U]=max(A)：返回行向量Y和U，Y向量记录A中每列的最大值，U向
      量记录每列最大值元素的行号。
      （3）max(A,[],dim)：dim取1或2。dim取1时，该函数的功能和max(A)完全
      相同；dim取2时，该函数返回一个列向量，其第i个元素是A矩阵的第i行上
      的最大值。
    - 求矩阵A的每行及每列的最大元素，并求整个矩阵的最大元素。

  ~~~
  >> A=[13,-56,78;25,63,-235;78,25,563;1,0,-1];
  >> max(A)
  ans=
  78 63 563
  >> max(A,[],2)
  ans=
  	78
  	63
  	563
  	1
  >> max(max(A)) 
  ans=
  	563
  ~~~

- 求矩阵的平均值和中值

  >- 平均值：指算术平均值，即每项数据之和除以项数。
  >- 中值：指在数据序列中其值的大小恰好处在中间的元素。如果数据个数为奇
  >  数，则取值为大小位于中间的元素；如果数据个数为偶数，则取中间两个元
  >  素的平均值。

  - 在MATLAB中，求平均值和中值的函数分别为：
    - mean()：求算术平均值。
    - median()：求中值。

  - 某学生宿舍的5位同学月生活费如向量x所示，其中，小明同学家
    境一般，请问他应该按什么标准向父母主张生活费额度才较为合理。
    x=[1200,800,1500,1000,5000]

    ~~~
    >> x=[1200,800,1500,1000,5000];
    >> mean(x)
    ans=
    	1900
    >> median(x)
    ans=
    	1200
    ~~~

- 求和与求积

  - sum():求和函数
  - prod():求积函数

- 累加和与累乘积

  > 每个元素自身从1累加或累乘

  - cumsum():累加和函数
  - cumprod():累乘积函数

  - 例子：求向量X=[1,2,3,4,5,6,7,8,9,10]的积与累乘积

    ~~~
    >> X=[1,2,3,4,5,6,7,8,9,10];
    >> y1=prod(X)
    y1=
    	3628800 
    %10！
    >> y2=cumprod(X)
    y2= 
    1 2 6 24 120 720 5040 40320 362880 3628800 
    %[1!,2!,3!...,10!]
    ~~~

- 标准差与相关系数

  > 标准差用于计算数据偏离平均数的距离的平均值

  - 标准差

    - MATLAB中计算标准差的函数为std()，其调用格式为：
      （1）std(X)：计算向量X的标准差。
      （2）std(A)：计算矩阵A的各列的标准差。
      （3）std(A,flag,dim)： flag取0或1，当flag=0时，按S1所列公式计
      算样本标准方差；当flag=1时，按S2所列公式计算总体标准方差。在默
      认情况下，flag=0，dim=1。
    - 生成满足正态分布的50000*4随机矩阵，用不同的形式求其各列之间
      的标准差

    ~~~
    >> x=randn(50000,4);
    >> y1=std(x,0,1)
    y1=
    0.9902 0.9881 0.9827 1.0007
    >> y2=std(x,1,1)
    y2=
    0.9901 0.9880 0.9826 1.0006
    >> x1=x';
    >> y3=std(x1,0,2);
    >> y3'
    ans=
    0.9902 0.9881 0.9827 1.0007
    >> y4=std(x1,1,2);
    >> y4’
    ans=
    0.9901 0.9880 0.9826 1.0006
    ~~~

  - 相关系数

    - 在MATLAB中，计算相关系数的函数为corrcoef()，其调用格式为：
      （1）corrcoef(A)：返回由矩阵A所形成的一个相关系数矩阵，其中，第i行第j
      列的元素表示原矩阵A中第i列和第j列的相关系数。
      （2）corrcoef(X,Y)：在这里，X,Y是向量，它们与corrcoef([X,Y])的作用一
      样，用于求X、Y向量之间的相关系数。

- 排序

  - 在MATLAB中，排序函数为sort()，其调用格式为：
    （1）sort(X)：对向量X按升序排列。
    （2）[Y,I]=sort(A,dim,mode)，其中dim指明对A的列还是行进行排序。mode
    指明按升序还是降序排序，若取“ascend”，则按升序；若取“descend”，
    则按降序，默认为升序。输出参数中，Y是排序后的矩阵，而I记录Y中的元素
    在A中位置。

  - 对下列矩阵做各种排序。

    ~~~
    >> A=[1,-8,5;4,12,6;13,7,-13];
    >> sort(A)
    ans=
    	1 -8 -13
    	4 7 5
    	13 12 6
    >> sort(A,2,'descend')
    ans =
    	5 1 -8
    	12 6 4
    	13 7 -13
    ~~~

    ~~~
    >> [X,I]=sort(A)
    X =
    	1 -8 -13
    	4 7 5
    	13 12 6
    I =
    	1 1 3
    	2 3 1
    	3 2 2
    ~~~

### 多项式计算

- 多项式的表示

  - 在MATLAB中，n次多项式用一个长度为n+1的行向量表示。有n次多项式

    则在MATLAB中，p(x)表示为向量形式

  - 在MATLAB中创建多项式向量时，要注意三点：
    （1）多项式系数向量的顺序是从高到低。
    （2）多项式系数向量包含0次项系数，所以其长度为多项式最高次数加1。 

    （3）如果有的项没有，系数向量相应位置应用0补足

- 多项式的四则运算

    - （1）多项式的加减运算
        多项式的加减运算非常简单，即相应向量相加减。
       （2）多项式乘法
       conv(P1,P2)：多项式相乘，其中，P1、P2是两个多项式系数向量。
       （3）多项式除法
       	[Q,r]=deconv(P1,P2)：多项式相除，其中Q返回多项式P1除以P2的商式，r返回P1除以P2的余式。这里，Q和r仍是多项式系数向量。deconv是conv的逆函数，因此有下式成立。
                                    P1=conv(Q,P2)+r
       
       ~~~
       >> f=[3,-5,0,-7,5,6]; g=[3,5,-3]; g1=[0,0,0,g];
       >> f+g1
       ans =
       3 -5 0 -4 10 3
       >> f-g1
       ans =
       3 -5 0 -10 0 9
       >> conv(f,g)
       ans=
       9 0 -34 -6 -20 64 15 -18
       >> [Q,r]=deconv(f,g)
       Q =
       1.0000 -3.3333 6.5556 -16.5926
       r =
       0 0 0 0 107.6296 -43.7778
       >> conv(g,Q)+r
       ans =
       3.0000 -5.0000 0 -7.0000 5.0000 6.0000 %=f
       ~~~



- 多项式的求导

     - 在MATLAB中，多项式求导函数为polyder()，其调用格式为：
          （1）p=polyder(P)：求多项式P的导函数。
          （2）p=polyder(P,Q)：求P×Q的导函数。
          （3）[p,q]=polyder(P,Q)：求P/Q的导函数，导函数的分子存入p，分母存入q

          - 已知两个多项式，计算两个多项式的乘积的导函数、商的导函数。
         ~~~
         >> a=[3 1 0 -6];
         >> b=[1 2];
         >> polyder(a)
         ans =
              9 2 0
         >> c=polyder(a,b)
         c =
         12 21 4 -6
         >> [p,q]=polyder(a,b)
         p =
         6 19 4 6
         q =
         1 4 4
         ~~~



- 多项式的求值

  - polyval(p,x)：**代数**多项式求值，其中，p为多项式系数向量，x可以 是标量、向量或矩阵。若x为标量，则求多项式在该点的值；若x为向 量或矩阵，则对向量或矩阵中的每个元素求多项式的值

  - polyvalm(p,x)：**矩阵**多项式求值，其调用格式与polyval相同，但含 义不同。polyvalm函数要求x为方阵，以方阵为自变量求多项式的值

    ~~~
    设A为方阵，P代表多项式x3-5x2+8，那么polyvalm(P,A)的含义是：
    A*A*A-5*A*A+8*eye(size(A))
    而polyval(P,A)的含义是：
    A.*A.*A-5*A.*A+8*ones(size(A))
    ~~~

  - 以多项式x4+8x3-10为例，取一个2×2矩阵为自变量，分别用 polyval和polyvalm计算该多项式的值

    ~~~
    >> a=[1,8,0,0,-10];
    >> x=[-1,1.2;2,-1.8];
    >> y1=polyval(a,x)
    y1=
        -17.0000 5.8976
        70.0000 -46.1584
    >> y2=polyvalm(a,x)
    y2=
        -60.5840 50.6496
        84.4160 -94.3504
    ~~~

- 多项式的求根

  - 在MATLAB中，多项式求根函数为roots(p)，其中p为多项式的系数向量

  - 例如，求多项式 x4+8x3-10的根

    ~~~
    >> a=[1,8,0,0,-10];
    >> x=roots(a)
    x =
        -8.0194 + 0.0000i
        1.0344 + 0.0000i
        -0.5075 + 0.9736i
        -0.5075 - 0.9736i
    ~~~

  - 若已知多项式的全部根，则可以用poly函数建立起该多 项式，其调用格式为：

    ​                                          p=poly(x)

    ~~~
    例如，在以上语句之后，继续输入命令：
    >> p=poly(x)
    p=
        1.0000 8.0000 0.0000 0.0000 -10.0000 %=a
    ~~~



###  数据插值（观测数据的误差较小，则可将其作为准确值来处理时的一种逼近函数方法）

- 引例-零件加工问题

- 在飞机制造中，机翼的加工是一项关键技术。由于机翼尺寸很大，通常 在图纸中只能标出一些关键点的数据。下表给出了某型飞机机翼的下缘 轮廓线数据，求x每改变0.1时y的值

  | x    | 0    | 3    | 5    | 7    | 9    | 11   | 12   | 13   | 14   | 15   |
  | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
  | y    | 0    | 1.2  | 1.7  | 2.0  | 2.1  | 2.0  | 1.8  | 1.2  | 1.0  | 1.6  |
  
  ~~~
  >> x=[0,3,5,7,9,11,12,13,14,15];
  >> y=[0,1.2,1.7,2.0,2.1,2.0,1.8,1.2,1.0,1.6];
  >> x1=0:0.1:15;
  >> y1=interp1(x,y,x1,'spline');
  >> plot(x1,y1)
  ~~~
  
- 数据插值的计算机制

  - 从数学上来说，数据插值是一种函数逼近的方法
  - 用近似函数去逼近未知函数

- 数据插值的实现方法

  - 在MATLAB中，一维插值函数为interp1()，其调用格式为：                                    Y1=interp1(X,Y,X1,method) 

    该语句将根据X、Y的值，计算函数在X1处的值。其中，X、Y是两个等长 的已知向量，分别表示采样点和采样值。X1是一个向量或标量，表示要插值的点
    
  - method参数用于指定插值方法，常用的取值有以下四种：

    - linear：线性插值，默认方法。将与插值点靠近的两个数据点用直线连 接，然后在直线上选取对应插值点的数据

    - nearest：最近点插值。选择最近样本点的值作为插值数据

    - **！！！**pchip：分段3次埃尔米特插值。采用分段三次多项式，除满足插值条 件，还需满足在若干节点处相邻段插值函数的一阶导数相等，使得曲线光 滑的同时，还具有保形性

    - **！！！**spline：3次样条插值。每个分段内构造一个三次多项式，使其插值 函数除满足插值条件外，还要求在各节点处具有连续的一阶和二阶导数

      > 四种方法的比较
      >
      > ​		线性插值和最近点插值方法比较简单。其中线性插值方法的计算量与样本点 n无关。n越大，误差越小。
      >
      > ​		3次埃尔米特插值和3次样条插值都能保证曲线的光滑性。相比较而言，3次 埃尔米特插值具有保形性；而3次样条插值要求其二阶导数也连续，所以插 值函数的性态更好.


  - MATLAB中的二维插值函数为interp2()，其调用格式为：    Z1=interp2(X,Y,Z,X1,Y1,method) 

    其中，X、Y是两个向量，表示两个参数的采样点，Z是采样 点对应的函数值。X1、Y1是两个标量或向量，表示要插值 的点。

  - 粮储仓的通风控制问题 

    在某粮情自动测控系统中，根据粮温、粮湿计算平衡点湿度，与大气湿 度进行比较，再根据通风模拟情况决定是否自动进行通风。已测得平衡 点湿度与粮温、粮湿关系的部分数据如下表，请推算相应范围内温度每 变化1度、湿度每变化1个点的平衡点湿度

    ~~~
    >> x=20:10:90;
    >> y=(0:5:20)';
    >> z=[8.9,10.32,11.3,12.5,13.9,15.3,17.8,21.3;
    8.7,10.8,11,12.1,13.2,14.8,16.55,20.8;
    8.3,9.65,10.88,12,13.2,14.6,16.4,20.5;
    8.1,9.4,10.7,11.9,13.1,14.5,16.2,20.3;
    8.1,9.2,10.8,12,13.2,14.8,16.9,20.9];
    >> xi=20:90;
    >> yi=(0:20)';
    >> zi=interp2(x,y,z,xi,yi,'spline');
    >> surf(xi,yi,zi)
    ~~~

### **数据插值应用（看ppt5.4）**

### **曲线拟合方法（如果观测数据的误差较大，不可能也没有必要将它作为准确值来处理时的方法）**

- 引例-人口预测问题

- 人口增长是当今世界上都关注的问题，对人口增长趋势进行预测是 各国普遍的做法。已知某国1790年到2010年间历次人口普查数据如下表所示，请预测该国2020年的人口数

  ~~~
  x=1790:10:2010;
  y=[3.9,5.3,7.2,9.6,12.9,17.1,23.2,31.4,38.6,50.2,63.0,76.0,92.0, ...
  105.7,122.8,131.7,150.7,179.3,203.2,226.5,248.7,281.4,308.7];
  plot(x,y,'*');
  p=polyfit(x,y,3);
  polyval(p,2020)
  plot(x,y,'*',x,polyval(p,x));
  ~~~

  > **用什么类型的函数做逼近函数**?   多项式函数
  >
  > **误差最小到底怎么计算**?   最小二乘法

- 曲线拟合的实现方法

  - MATLAB中的多项式拟合函数为polyfit()，其功能为求得最小二乘拟合多项式系 数，其调用格式为：
  - （1）P=polyfit(X,Y,m)
  - （2）[P,S]=polyfit(X,Y,m)
  - （3）[P,S,mu]=polyfit(X,Y,m)：根据样本数据X和Y，产生一个m次多项式P及 其在采样点误差数据S，mu是一个二元向量，mu(1)是mean(X)，而mu(2)是 std(X)。

- **！！！**

  - **（1）要对问题的背景进行详细的分析**

  - **（2）采样点并非越多越好，适当的时候，可以减少采样**

    **点，分段进行拟合**

### 曲线拟合应用举例(ppt5.6)

## 数值微积分与方程求解

### 数值微分与数值积分

- 数值微分

  - 数值微分的实现

  - MATLAB提供了求向前差分的函数diff，其调用格式有三种：

    - dx=diff(x)：计算向量x的向前差分，dx(i)=x(i+1)-x(i)，i=1，2，…，n-1。

    - dx=diff(x,n)：计算向量x的n阶向前差分。例如，diff(x,2)=diff(diff(x))。  dx=diff(A,n,dim)：计算矩阵A的n阶差分，dim=1时（默认状态），按列计算 差分；dim=2，按行计算差分。

    - **注意**：diff函数计算的是向量元素间的差分，故差分向量元素的个数比原向量少了 一个。同样，对于矩阵来说，差分后的矩阵比原矩阵少了一行或一列。  另外，计算差分之后，可以用f(x)在某点处的差商作为其导数的近似值。

    - 设f(x)=sinx，在[0，2π ]范围内随机采样，计算f'(x)的近似值，并与 理论值f'(x)=cosx 进行比较

      ~~~
      >> x=[0,sort(2*pi*rand(1,5000)),2*pi]; 
      >> y=sin(x); 
      >> f1=diff(y)./diff(x); 
      >> f2=cos(x(1:end-1)); 
      >> plot(x(1:end-1),f1,x(1:end-1),f2); 
      >> d=norm(f1-f2) 
      d = 
       0.0433
      ~~~

- 数值积分

  - 数值积分基本原理

    - 在高等数学中，计算定积分依靠微积分基本定理，只要找到被积函数f(x) 的原函数大F(x)，则可用牛顿—莱布尼兹（Newton-Leibniz）公式：
    - 在有些情况下，应用牛顿—莱布尼兹公式有困难，例如，当被积函数的原函 数无法用初等函数表示，或被积函数是用离散的表格形式给出的。这时就需 要用数值解法来求定积分的近似值。
    - 求定积分的数值方法多种多样，如梯形法、辛普森（Simpson）法、高斯求积公式 等。它们的基本思想都是将积分区间[a，b]分成n个子区间[xi，xi+1]，i=1，2，…， n，其中x1=a，xn+1=b，这样求定积分问题就分解为下面的求和问题
    - 在每一个小的子区间上定积分的值可以近似求得,从而避免了牛顿—莱布尼兹公式需要寻求原函数的困难。

  - 数值积分的实现

    - 基于自适应辛普森方法

      -  [I,n]=quad(filename,a,b,tol,trace)

    - 基于自适应Gauss-Lobatto方法

      - [I,n]=quadl(filename,a,b,tol,trace)

    - 其中，filename是被积函数名；a和b分别是定积分的下限和上限，积分限[a，b]必须是有限的，不能为无穷大（Inf）；tol用来控制积分精度，默认时取 tol=10-6；trace控制是否展现积分过程，若取非0则展现积分过程，取0则不展 现，默认时取trace=0；返回参数I即定积分的值，n为被积函数的调用次数

    - 分别用quad函数和quadl函数求定积分的近似值，并在相同的积分精度下， 比较被积函数的调用次数

      ~~~
      >> format long 
      >> f=@(x) 4./(1+x.^2); 
      >> [I,n]=quad(f,0,1,1e-8) 
      I = 
       3.141592653733437 
      n = 
       61 
      >> [I,n]=quadl(f,0,1,1e-8) 
      I = 
       3.141592653589806 
      n = 
       48 
      >> (atan(1)-atan(0))*4 
      ans = 
       3.141592653589793 
      >> format short
      ~~~

    - 基于全局自适应积分方法

      - I=integral(filename,a,b)

      - 其中，I是计算得到的积分；filename是被积函数；a和b分别是定积分的下限和上限，积分限可以为无穷大

      - 求定积分

        ~~~
        function f=fe(x) 
        f=1./(x.*sqrt(1-log(x).^2)); 
        >> I=integral(@fe,1,exp(1)) 
        I = 
         1.5708
        ~~~

      - 基于自适应高斯-克朗罗德方法

        - [I,err]=quadgk(filename,a,b)

        - 其中，err返回近似误差范围，其他参数的含义和用法与quad函数相同。积分上下限可以是无穷大（−Inf或Inf），也可以是复数。如果积分上下限是复数，则quadgk函数在复平面上求积分

          ~~~
          function f=fsx(x) 
          f=sin(1./x)./x.^2; 
          >> I=quadgk(@fsx,2/pi,+Inf) 
          I = 
           1.0000
          ~~~

        - 基于梯形积分法

          - I=trapz(x,y)

          - 其中，向量x、y定义函数关系y=f(x)

          - 可以用这条语句实现

            ~~~
            sum(diff(x).*(y(1:end-1)+y(2:end))/2)
            ~~~

          - 设x=1:6，y=[6,8,11,7,5,2],用trapz函数计算定积分

            ~~~
            >> x=1:6; 
            >> y=[6,8,11,7,5,2]; 
            >> plot(x,y,'-ko'); 
            >> grid on 
            >> axis([1,6,0,11]); 
            >> I1=trapz(x,y) 
            I1 = 
             35 
            >> I2=sum(diff(x).*(y(1:end-1)+y(2:end))/2) 
            I2 = 
             35
            ~~~

  - 多重定积分的数值求解

    - 求二重积分的数值解(范围从里到外)

      - I=integral2(filename,a,b,c,d)  
      - I=quad2d(filename,a,b,c,d)  
      - I=dblquad(filename,a,b,c,d,tol)

    - 求三重积分的数值解

      - I=integral3(filename,a,b,c,d,e,f) 

      - I=triplequad(filename,a,b,c,d,e,f,tol)

      - 分别求二重积分和三重积分

        ~~~
        >> f1=@(x,y) exp(-x.^2/2).*sin(x.^2+y); 
        >> I1=quad2d(f1,-2,2,-1,1) I1 = 
         1.574 
        >> f2=@(x,y,z) 4*x.*z.*exp(-z.*z.*y-x.*x); 
        >> I2=integral3(f2,0,pi,0,pi,0,1) 
        I2 = 
         1.7328
        ~~~

### 线性方程组求解

- 线性方程组的直接解法

  - 高斯（Gauss）消去法

    > 高斯（Gauss）消去法是一个经典的直接法，由它改进得到的列主元消去法，是目前计算机上求解线性方程组的标准算法，其特点就是通过消元将一般线性方程组的求解问题转化为三角方程组的求解问题。此外，还有矩阵的三角分解法等许多直接求解算法

    - 利用左除运算符的直接解法 

      - MATLAB提供了一个左除运算符“\”用于求解线性方程组，它使用列主元消去法，使用起来十分方便。对于线性方程组Ax=b，可以利用左除运算符反斜杠求解，b左除以A可获得线性方程组的数值解x
      - **Ax=b**   ----->>    **x=A\b**
      - **注意，如果矩阵A是奇异的或接近奇异的，则MATLAB会给出警告信息**

    - **用左除运算符求解下列线性方程组**

      ~~~
      >> A=[2,1,-5,1;1,-5,0,7;0,2,1,-1;1,6,-1,-4]; 
      >> b=[13,-9,6,0]'; 
      >> x=A\b 
      x = 
       -66.5556 
       25.6667 
       -18.7778 
       26.5556
      ~~~

    - 利用矩阵分解求解线性方程组

      - 矩阵分解是设计算法的重要技巧，是指将一个给定的矩阵分解成若干个特
        殊类型矩阵的乘积，从而将一个一般的矩阵计算问题转化为几个易求的特
        殊矩阵的计算问题。通过矩阵分解方法求解线性方程组的优点是运算速度
        快，可以节省存储空间

        > LU分解 
        >
        > QR分解 
        >
        > Cholesky分解

      - **LU分解的基本思想**

        - 矩阵的LU分解就是将一个n阶矩阵表示为一个下三角矩阵和一个上三角矩阵的乘积。线性代数中已经证明，只要方阵是非奇异的，LU分解总是可以进行的对于三角方程很容易求解，于是可以首先求解向量y使Ly=b，再求解Ux=y，从而达到求解线性方程组Ax=b的目的

        - LU分解函数是根据列主元LU分解算法定义的，具有较好的数据稳定性。lu函数有两种调用格式：

          - [L,U]=lu(A)：产生一个上三角阵U和一个变换形式的下三角阵L，使之满足A=LU。注意，这里的矩阵A必须是方阵
          - [L,U,P]=lu(A)：产生一个上三角阵U和一个下三角阵L以及一个置换矩阵P，使之满足PA=LU。同样，矩阵A必须是方阵

        - 当使用第一种格式时，矩阵L往往不是一个下三角阵，但可以通过行交换成为一个下三角阵

          - 用LU分解求解线性方程组

            >Ax=b→LUx=b→x=U\(L\b) 
            >
            >或 
            >Ax=b→ PAx=Pb→ LUx=Pb → x=U\(L\P*b) 
            >通过LU分解后可以大大提高运算速度

          - 用LU分解求解例1中的线性方程组

            ~~~
            >> A=[2,1,-5,1;1,-5,0,7;0,2,1,-1;1,6,-1,-4]; 
            >> b=[13,-9,6,0]'; 
            >> [L,U]=lu(A); 
            >> x=U\(L\b) 
            x = 
             -66.5556 
             25.6667 
             -18.7778 
             26.5556
            ~~~

            ~~~
            >> A=[2,1,-5,1;1,-5,0,7;0,2,1,-1;1,6,-1,-4]; 
            >> b=[13,-9,6,0]';
            >> [L,U,P]=lu(A); 
            >> x=U\(L\P*b)
            x = 
             -66.5556 
             25.6667 
             -18.7778 
             26.5556
            ~~~

  - 线性方程组的迭代解法

    - 迭代法是一种不断用变量的原值推出它的新值的过程，是用计算机解决问题的一种基本方法

    - 雅可比迭代法的函数文件jacobi.m：

      ~~~
      function [y,n]=jacobi(A,b,x0,ep) 
      D=diag(diag(A)); 
      L=-tril(A,-1); 
      U=-triu(A,1); 
      B=D\(L+U); 
      f=D\b; 
      y=B*x0+f; 
      n=1; 
      while norm(y-x0)>=ep 
       x0=y; 
       y=B*x0+f; 
       n=n+1; 
      end
      ~~~

    - 高斯-赛德尔（Gauss-Serdel）迭代法的函数文件gauseidel.m：

      ~~~
      function [y,n]=gauseidel(A,b,x0,ep) 
      D=diag(diag(A)); 
      L=-tril(A,-1); 
      U=-triu(A,1); B=(D-L)\U; 
      f=(D-L)\b; 
      y=B*x0+f; 
      n=1; 
      while norm(y-x0)>=ep 
       x0=y; 
       y=B*x0+f; 
       n=n+1; 
      end
      ~~~

    -  分别用雅可比迭代法和高斯-赛德尔迭代法求解线性方程组。设迭代初值为0，迭代精度为10^-6

      ~~~
      >> A=[4,-2,-1;-2,4,3;-1,-3,3]; 
      >> b=[1,5,0]'; 
      >> [x,n]=jacobi(A,b,[0,0,0]',1.0e-6) 
      x = 
       0.9706 
       0.8529 
       1.1765 
      n = 
       35
      ~~~

      ~~~
      >> [x,n]=gauseidel(A,b,[0,0,0]',1.0e-6) 
      x = 
       0.9706 
       0.8529 
       1.1765 
      n = 
       16
      ~~~

### 线性方程组应用举例(看ppt6.3)

### 非线性方程求解与函数极值计算

- 非线性方程数值求解

  - （1）单变量非线性方程求解函数的调用格式为：
                         x=fzero(filename,x0)
    其中，filename是待求根方程左端的函数表达式，x0是初始值。

  - 求 在x0=-5和x0=1作为迭代初值时的根

    ~~~
    >> f=@(x) x-1./x+5;
    >> x1=fzero(f,-5)
    x1 =
    -5.1926
    >> x2=fzero(f,1)
    x2 =
    0.1926
    >> x3=fzero(f,0.1)
    x3 =
    3.7372e-16
    ~~~

    取x=0点附近的初值,看看结果如何（x3），显然x3不是方程的解，所以利用
    fzero函数求解方程，初值的选取是很重要的。在使用MATLAB进行问题求解时，
    需要对问题进行多角度分析，而不能机械地套用命令或程序

    - f(x)=x2-1=0的根

      ~~~
      f=@(x) x.^2-1;
      x=[];
      x0=-0.25:0.001:0.25;
      for x00=x0
      x=[x,fzero(f,x00)];
      end
      plot(x0,x,'-o')
      xlabel('初值');
      ylabel('方程的根');
      axis([-0.25,0.25,-1,1])
      ~~~

      结果表明，在零附近，相同的根所对应的初值范围并不连续，求得的根也并
      非是离初值比较近的根。所以fzero函数执行的是一个数值搜索过程，搜索结
      果依赖于函数特性和指定的初值

  - 在MATLAB的最优化工具箱中提供了非线性方程组的求解函数fsolve，其调用
    格式如下：

    x=fsolve(filename,x0,option)

    其中，x为返回的近似解，filename是待求根方程左端的函数表达式，x0是初值，
    option用于设置优化工具箱的优化参数，可以调用optimset函数来完成。例如，
    Display参数设置为‘off’时不显示中间结果

    - 利用fsolve函数解例1的方程

    ~~~
    >> f=@(x) x-1./x+5;
    >> x1=fsolve(f,-5,optimset('Display','off'))
    x1 =
    -5.1926
    >> x2=fsolve(f,1,optimset('Display','off'))
    x2 =
    0.1926
    >> x3=fsolve(f,0.1,optimset('Display','off'))
    x3 =
    0.1926
    ~~~

    当初值是0.1时，利用fzero函数无法得到正确结果，这里利用fsolve函数就能
    得到正确结果，因为不同函数的实现方法不同，适用的场合也不同。总之，多
    角度选择和分析是很有必要的

  - 求下列方程组在（1，1，1）附近的解并对结果进行验证

    ~~~
    >> f=@(x) [sin(x(1))+x(2)+x(3)^2*exp(x(1)),x(1)+x(2)+x(3),x(1)*x(2)*x(3)];
    >> f([1,1,1])
    ans =
    	4.5598 3.0000 1.0000
    >> x=fsolve(f,[1,1,1],optimset('Display','off'))
    x =
    	0.0224 -0.0224 -0.0000
    >> f(x)
    ans =
    	1.0e-06 *
    	-0.5931 -0.0000 0.0006
    ~~~

- 函数极值的计算

  - 函数极值包括极大值和极小值，或者叫最大值和最小值。MATLAB只考虑最
    小值问题的计算，如果要求f(x)的最大值，可以通过求-f(x)的最小值来解
    决

  - 无约束最优化问题

    - 求最小值的函数为：
      - [xmin,fmin]=fminbnd(filename,x1,x2,option)
        [xmin,fmin]=fminsearch(filename,x0,option)
        [xmin,fmin]=fminunc(filename,x0,option)
      - 其中，xmin表示极小值点，fmin表示最小值，filename是定义的目标函数。第一个函数的输入变量xl、x2分别表示被研究区间的左、右边界。后两个函数的输入变量x0是一个向量，表示极值点的初值。option为优化参数，可以通过optimset函数来设置
    - 求函数 ，在区间(-10，-1)和(1，10)上的最小值点

    ~~~
    >> f=@(x) x-1./x+5;
    >> [xmin,fmin]=fminbnd(f,-10,-1)
    xmin = -9.9999
    fmin = -4.8999
    >> [xmin,fmin]=fminbnd(f,1,10)
    xmin =
    	1.0001
    fmin =	
    	5.0001
    ~~~

  - 有约束最优化问题

    - 求取一组x，使得目标函数f(x)为最小，且满足约束条件G(x)≤0。记号s.t.
      是英文subject to的缩写，表示x要满足后面的约束条件。

    - 约束条件可以进一步细化为：线性不等式约束、线性等式约束、非线性不等
      式约束、非线性等式约束以及x的下界和上界。

    - 求有约束条件下最小值的函数为：

      [xmin,fmin]=fmincon(filename,x0,A,b,Aeq,beq,Lbnd,Ubnd,NonF,option)

      其中，xmin、fmin、filename、x0和option的含义与求最小值函数相同。其余
      参数为约束条件，包括线性不等式约束、线性等式约束、x的下界和上界以及定
      义非线性约束的函数。如果某个约束不存在，则用空矩阵来表示

    - 求解有约束最优化问题

      ~~~
      f=@(x) 0.4*x(2)+x(1)^2+x(2)^2-x(1)*x(2)+1/30*x(1)^3;
      x0=[0.5;0.5];
      A=[-1,-0.5;-0.5,-1];
      b=[-0.4;-0.5];
      lb=[0;0];
      option=optimset('Display','off');
      [xmin,fmin]=fmincon(f,x0,A,b,[],[],lb,[],[],option)
      xmin =
      	0.3396
      	0.3302
      fmin =
      	0.2456
      ~~~

### 常微分方程数值求解

- 所谓其数值解法，就是求y(t)在离散结点tn处的函数近似值yn的方法，yn≈y(xn)。
  这些近似值称为常微分方程初值问题的数值解。相邻两个结点之间的距离称为
  步长。

- **数值解法**

  - 单步法：在计算yn+1时只用到前一步的yn,因此在有了初值之后就可以逐步往下计算，其代表是龙格-库塔（Runge-Kutta）法。
  - 多步法：在计算yn+1时,除了用到前一步的值yn之外,还要用到yn-p（p=1，2，…，k， k＞0）的值,即前面的k步。其代表就是亚当斯(Adams)法。

- 常微分方程数值求解函数

  - MATLAB提供了多个求常微分方程初值问题数值解的函数，一般调用格式为：
    [t,y]=solver(filename,tspan,y0,option) %solver要替换
    其中，t和y分别给出时间向量和相应的数值解。**solver**为求常微分方程数值解
    的函数。filename是定义f(t，y)的函数名，该函数必须返回一个列向量。
    tspan形式为[t0，tf]，表示求解区间。y0是初始状态向量。Option是可选参数，
    用于设置求解属性，常用的属性包括相对误差值RelTol(默认值是10^-3)和绝对误
    差值AbsTol(默认值是10^-6)。

  - solver的函数

    - | 求解函数 | 采用方法                        | 适用场合                               |
    | -------- | ------------------------------- | -------------------------------------- |
    | ode23    | 2阶或3阶Runge-Kutta算法，低精度 | 非刚性                                 |
    | ode45    | 4阶或5阶Runge-Kutta算法，中精度 | 非刚性                                 |
    | ode113   | Adams算法，精度可到10^-3～10^-6 | 非刚性，计算时间比ode45短              |
    | ode23t   | 梯形算法                        | 适度刚性                               |
    | ode15s   | Gear's反向数值微分算法，中精度  | 刚性                                   |
    | ode23s   | 2阶Rosebrock算法，低精度        | 刚性，当精度较低时，计算时间比ode15s短 |
    | ode23tb  | 梯形算法，低精度                | 刚性，当精度较低时，计算时间比ode15s短 |


  - 求解微分方程初值问题，并与精确解进行比较

    ~~~
    f=@(t,y) (y^2-t-2)/4/(t+1);
    [t,y]=ode23(f,[0,10],2);
    y1=sqrt(t+1)+1;
    plot(t,y,'b:',t,y1,'r');
    ~~~

  - 已知一个二阶线性系统的微分方程为： 取a=2，绘制系统的时间响应曲线和相平面图。
    令x2=x，x1=x’，则得到系统的状态方程

    ~~~
    f=@(t,x) [-2,0;0,1]*[x(2);x(1)]; %调了顺序的方程组
    [t,x]=ode45(f,[0,20],[1,0]); 
    subplot(2,2,1);plot(t,x(:,2)); %x’与t的
    subplot(2,2,2);plot(x(:,2),x(:,1));
    ~~~

  - **刚性问题**

    - **有一类常微分方程，其解的分量有的变化很快，有的变化很慢，且相差悬殊，**

      **这就是所谓的刚性问题(Stiff)。**

      **对于刚性问题，数值解算法必须取很小步长才能获得满意的结果，导致计算**

      **量会大大增加。解决刚性问题需要有专门方法。非刚性算法可以求解刚性问**

      **题，只不过需要很长的计算时间。**

    - 假如点燃一个火柴，火焰球迅速增大直至某个临界体积，然后，维
      持这一体积不变，原因是火焰球内部燃烧耗费的氧气和从球表面所获氧气
      达到平衡。其简化模型如下：
      y’=y2-y3
      y(0)=λ
      0≤t≤2/λ
      其中，y(t)代表火焰球半径，初始半径是λ，它很小。分析λ的大小对方
      程求解过程的影响。

      ~~~matlab
      lamda=0.01;
      f=@(t,y) y^2-y^3;
      tic;[t,y]=ode45(f,[0,2/lamda],lamda);toc
      disp(['ode45计算的点数' num2str(length(t))]);
      ~~~

      > **时间已过 0.005774 秒。**
      >
      > **ode45计算的点数157**

      - **tic和toc函数用来记录微分方程求解命令执行的时间，使用tic函数启动计时**

        **器，使用toc函数显示从计时器启动到当前所经历的时间。最后还输出计算的**

        **点数，运行结果表明这时常微分方程不算很刚性。**

      ~~~matlab
      lamda=1e-5;
      f=@(t,y) y^2-y^3;
      tic;[t,y]=ode45(f,[0,2/lamda],lamda);toc
      disp(['ode45计算的点数' num2str(length(t))]);
      ~~~

      >**时间已过 2.946947 秒。**
      >
      >**ode45计算的点数120565**

    - **这时计算时间明显加长，计算的点数剧增，表明这时常微分方程表现为刚性。**

      ~~~matlab
      lamda=1e-5;
      f=@(t,y) y^2-y^3;
      tic;[t,y]=ode15s(f,[0,2/lamda],lamda);toc
      disp(['ode15s计算的点数' num2str(length(t))]);
      ~~~

      >**时间已过 0.070974 秒。**
      >
      >**ode15s计算的点数98**

    - **对于刚性问题，我们需要改变求解算法。我们选择以“s”结尾的函数，他们**

      **专门用于求解刚性方程。计算时间大大缩短，计算的点数大大减少。**



## MATLAB符号计算

### 符号对象

- 符号对象的建立

  - sym函数
    sym函数用于建立单个符号对象，其常用调用格式为：
    符号对象名=sym(A)
    将由A来建立符号对象。其中，A可以是一个数值常量、数
    值矩阵或数值表达式（不加单引号），此时符号对象为一
    个符号常量；A也可以是一个变量名（加单引号），这时
    符号对象为一个符号变量

  - 请对比以下程序：

    ~~~matlab
    >> t=sym(2);
    >> t+1/2
    ans=
    	5/2
    >> sin(sym(pi/3))
    ans =
    	3^(1/2)/2
    >> sin(pi/3)
    ans =
    	0.8660
    ~~~

    ~~~matlab
    >> a=5;
    >> b=-8;
    >> x=sym('a');
    >> y=sym('b');
    >> w=(a+b)*(a-b)
    w =
    	-39
    >> s=(x+y)*(x-y)
    s =
    	(a + b)*(a - b)
    >> eval(s)
    ans =
    	-39
    ~~~

  - **由以上的例子我们可以看出：**

    - **符号计算的结果是一个精确的数学表达式。**

      > 如3^(1/2)/2

    - **数值计算的结果是一个数值。**

      > 如0.8660

  - syms命令

    syms命令可以一次定义多个符号变量，其一般调用格式如下：
    syms 符号变量名1 符号变量名2 … 符号变量名n
    其中，变量名不能加单引号，相互之间用空格隔开。
    例如，要同时定义四个符号变量a、b、c、d，则可以输入如下
    命令：

    ~~~matlab
    >> syms a b c d
    ~~~

- 符号对象的运算

  - 四则运算

    符号表达式的四则运算与数值运算一样，用+、-、*、/、^ 运
    算符实现，其运算结果依然是一个符号表达式。例如：

    ~~~matlab
    >> syms x;
    >> f=2*x^2+3*x-5;
    >> g=x^2-x+7;
    >> f+g
    ans =
    	3*x^2 + 2*x + 2
    ~~~

  - 关系运算

    6种关系运算符：<、<=、>、>=、==、～=。

    对应的6个函数：lt()、le()、gt()、ge()、eq()、ne()。

    若参与运算的是符号表达式，其结果是一个符号关系表达
    式；若参与运算的是符号矩阵，其结果是由符号关系表达式组
    成的矩阵。

    - 在进行符号对象的运算前，可用assume函数对符号对象设置值域，
      函数调用格式为：

      ​							assume(condition)
      ​							assume(expr,set)

      第一种格式指定变量满足条件condition，第二种格式指定表达式
      expr属于集合set。

      ~~~matlab
      >> syms x;
      >> assume(x<0);
      >> abs(x)==x
      ans=
      	-x==x
      ~~~

      > 因为x<0，所以abs(x)的值为-x。

      ~~~matlab
      >> assume(x,'positive');
      >> abs(x)==x
      ans=
      	x==x
      ~~~

      > 因为x为正数，所以abs(x)的值为x。

  - 逻辑运算

    3种逻辑运算符：&（与）、|（或）和～（非）。

    4个逻辑运算函数：and(a,b)、or(a,b)、not(a)和xor(a,b)。

    ~~~matlab
    >> syms x;
    >> y=x>0 & x<10
    y=
    	0<x & x<10
    ~~~

    ​						||

    ​						||

    ~~~
    >> y=and(x>0,x<10)
    y=
    	0<x & x<10
    ~~~

  - 因式分解与展开运算

    MATLAB提供了符号表达式的因式分解与展开的函数，函数的调用格式为：

    - factor(s)：对符号表达式s分解因式。
    - expand(s)：对符号表达式s进行展开。
    - collect(s)：对符号表达式s合并同类项。
    - collect(s,v)：对符号表达式s按变量v合并同类项。

    ~~~matlab
    >> syms a b;
    >> s=a^3-b^3;
    >> factor(s) 
    ans=
    	[ a-b, a^2 + a*b + b^2]
    ~~~

    ~~~matlab
    >> factor(12)
    ans=
    	2 2 3
    ~~~

  - 其他运算

    - 提取有理分式的分子分母：[n,d]=numden(s)。

    - 提取符号表达式的系数：c=coeffs(s,x)。

    - 符号表达式化简：simplify(s)。

    - 符号多项式与多项式系数向量之间的转换：

      - 符号多项式转换为多项式系数向量：p=sym2poly(s)。
      - 多项式系数向量转换为符号多项式：s=poly2sym(p)。

    - 例1 求方程ax2+bx+c=0的根。

      ~~~matlab
      >> syms a b c x;
      >> f=a*x^2+b*x+c 
      f =
      a*x^2 + b*x + c
      >> g=coeffs(f,x)
      g =
      [ c, b, a]
      >> g=g(end:-1:1)
      g =
      [ a, b, c] 
      >> roots(g)
      ans = 
      -(b + (b^2 - 4*a*c)^(1/2))/(2*a)
      -(b - (b^2 - 4*a*c)^(1/2))/(2*a)
      ~~~

  - 符号运算中变量的确定

    - 如果没有明确指定自变量，MATLAB将按以下原则确定主变量并对其进行相应运算:

      - 寻找除i、j之外，在字母顺序上最接近x的小写字母。
      - 若表达式中有两个符号变量与x的距离相等，则ASCII码大者优先。

    - symvar()函数可以用于查找一个符号表达式中的符号变量，函数的调用格式为：

      ​                                         symvar(s,n)

      函数返回符号表达式s中的n个符号变量。因此，可以用symvar(s,1)查找表达式s的主变量。

- 符号矩阵

  - 符号矩阵也是一种符号表达式，所以符号表达式运算都可以在矩阵意
    义下进行。

    注意：这些函数作用于符号矩阵时，是分别作用于矩阵的每一个元素。
    例如：建立符号矩阵并化简。

    ~~~matlab
    >> syms a b x y alp;
    >> m=[a^3-b^3,sin(alp)^2+cos(alp)^2;(15*x*y-3*x^2)/(x-5*y),78]
    m =
    	[ a^3 - b^3,cos(alp)^2 + sin(alp)^2]
    	[(- 3*x^2 + 15*y*x)/(x - 5*y), 78]
    >> simplify(m)
    ans =
    	[ a^3 - b^3, 1]
    	[ -3*x, 78]
    ~~~

  - 当λ取何值时，以下齐次线性方程组有非零解。

    > 对于齐次线性方程组Ax=0，当
    > rank(A)<n或|A|=0时，齐次线
    > 性方程组有非零解。

    ~~~matlab
    syms lamda;
    A=[1-lamda,-2,4;2,3-lamda,1;1,1,1-lamda];
    D=det(A);
    factor(D)
    ~~~

    程序运行结果为：

    ~~~matlab
    ans =
    	[-1, lamda, lamda - 2, lamda - 3]
    ~~~

    从而得知，当λ=0、λ=2或λ=3时，原方程组有非零解。

### 符号微积分

- 符号函数的极限

  - 求符号函数极限的命令为limit，其调用格式为：

    ​       limit(f,x,a)

    即求函数f关于变量x在a点的极限。

  - limit函数的另一种功能是求单边极限，其调用格式为：

    ​       limit(f,x,a,'right')

    ​		limit(f,x,a,'left')

  - 求下列极限。

    ~~~matlab
    >> syms a m x n;
    >> f=(x^(1/m)-a^(1/m))/(x-a);
    >> limit(f,x,a) 
    ans =
    	a^(1/m - 1)/m
    >> g=(1+1/n)^n;
    >> limit(g,n,inf) 
    ans =
    	exp(1) %即自然常数e。
    ~~~

- 符号函数的导数

  MATLAB中的求导函数为：

  ​						diff(f,x,n)

  ​	即求函数f关于变量x的n阶导数。参数x的用法同求极限
  ​	函数limit，可以缺省，默认值与limit相同，n的默认值
  ​	是1

  - **求下列函数的导数。**

    ~~~matlab
    >> syms x y z;
    >> f=sqrt(1+exp(x));
    >> diff(f) 
    ans =
    	exp(x)/(2*(exp(x) + 1)^(1/2))
    ~~~

    ~~~matlab
    >> g=x*exp(y)/y^2;
    >> diff(g,x) 
    ans =
    	exp(y)/y^2 
    >> diff(g,y) 
    ans =
    	(x*exp(y))/y^2 - (2*x*exp(y))/y^3
    ~~~

- 符号函数的积分

  - 不定积分

    在MATLAB中，求不定积分的函数是int()，其常用
    的调用格式为：

    ​						int(f,x)

    即求函数f对变量x的不定积分。

    - 求下列不定积分。

    ~~~matlab
    >> syms x t;
    >> f=(3-x^2)^3;
    >> int(f)
    ans =
    	- x^7/7 + (9*x^5)/5 - 9*x^3 + 27*x
    >> g=5*x*t/(1+x^2);
    >> int(g,t) 
    ans =
    	(5*t^2*x)/(2*(x^2 + 1))
    ~~~

  - 定积分

    在MATLAB中，定积分的计算也使用int()函数，但调用格式有区别：

    ​							int(f,x,a,b)

    其中，a、b分别表示定积分的下限和上限。

    - 当函数f关于变量x在闭区间[a,b]可积时，函数返回一个定积分结果。
    - 当a、b中有一个是inf时，函数返回一个广义积分。
    - 当a、b中有一个符号表达式时，函数返回一个符号函数。

    求下列定积分。

    ~~~matlab
    >> syms x t;
    >> int(abs(1-x),1,2)
    ans =
    1/2
    >> int(1/(1+x^2),-inf,inf)
    ans =
    pi
    >> int(4*x/t,t,2,sin(x))
    ans =
    4*x*(log(sin(x)) - log(2))
    ~~~

### 级数

- 级数求和

  - 求无穷级数的和需要符号表达式求和函数symsum()，其调
    用格式为：
    				symsum(s,v,n,m)
    其中，s表示一个级数的通项，是一个符号表达式。v是求
    和变量，v省略时使用系统的默认变量。n和m是求和变量v
    的初值和末值。

  - 求下列级数之和。

    ~~~matlab
    >> syms n;
    >> s1=symsum(n^2,1,100)
    s1 =
    338350
    >> s2=symsum((-1)^(n-1)/n,1,inf)
    s2=
    log(2)
    >> s3=symsum((-1)^(n-1)/(2*n-1),n,1,inf)
    s3 =
    hypergeom([-1/2, 1], 1/2, -1)–1 
    >> hypergeom([-1/2, 1], 1/2, -1) %超几何函数
    ans =
    1.7854
    >> eval(s3)*4
    ans=
    3.141592653589792
    ~~~

    > 注意：在符号计算中，因为小数都表示为有理分数的形式，随着计算次数的
    > 增加，容易导致分子或分母出现极大整数从而无法计算的情况。

- 泰勒级数

  - MATLAB提供了taylor()函数将函数展开为幂级数，其调用
    格式为：
    			taylor(f,v,a,Name,Value)
    该函数将函数f按变量v在a点展开为泰勒级数，v的默认值
    与diff函数相同，a的默认值是0。 Name和Value为选项设
    置，经常成对使用，前者为选项名，后者为该选项的值。

  - Name有3个可取字符串：
    ① 'ExpansionPoint'：指定展开点，对应值可以是标量或向量。
    未设置时，展开点为0。 

    ② 'Order'：指定截断参数，对应值为一个正整数。未设置时，
    截断参数为6，即展开式的最高阶为5。 

    ③ 'OrderMode'：指定展开式采用绝对阶或相对阶，对应值为
    'Absolute' 或'Relative'。 未设置时取'Absolute'。

  - 求函数f在x=1处的5阶泰勒级数展开式

    ~~~matlab
    >> syms x;
    >> f=(1+x+x^2)/(1-x+x^2);
    >> taylor(f,x,1,'Order',6)
    ans =
    	2*(x - 1)^3 - 2*(x - 1)^2 - 2*(x - 1)^5 + 3
    >>expand(ans)
    ans =
    	- 2*x^5 + 10*x^4 - 18*x^3 + 12*x^2 + 1
    ~~~

### 符号方程求解

- 代数方程符号求解

  - 在MATLAB中，求解用符号表达式表示的代数方程可由函数
    solve()实现，其调用格式为：

    ① solve(s)：求解符号表达式s的代数方程，求解变量为
    默认变量。
    ② solve(s,v)：求解符号表达式s的代数方程，求解变量
    为v。 

    ③ solve(s1,s2,…,sn,v1,v2,…,vn)：求解符号表达式
    s1，s2，…，sn组成的代数方程组，求解变量分别为v1，
    v2，…，vn。

  - 解方程 ax^2+bx+c=0。

    ~~~matlab
    >> syms x y a b c;
    ~~~

    ~~~matlab
    >> solve(a*x^2+b*x+c==0)
    ans =
    -(b + (b^2 - 4*a*c)^(1/2))/(2*a)
    -(b - (b^2 - 4*a*c)^(1/2))/(2*a)
    ~~~

    ~~~matlab
    >> solve(a*x^2+b*x+c)
    ans =
    -(b + (b^2 - 4*a*c)^(1/2))/(2*a)
    -(b - (b^2 - 4*a*c)^(1/2))/(2*a)
    ~~~

    ~~~matlab
    >> f=a*x^2+b*x+c==0;
    >> solve(f)
    ans =
    -(b + (b^2 - 4*a*c)^(1/2))/(2*a)
    -(b - (b^2 - 4*a*c)^(1/2))/(2*a)
    ~~~

    ~~~matlab
    >> f=a*x^2+b*x+c
    >> solve(f)
    ans =
    -(b + (b^2 - 4*a*c)^(1/2))/(2*a)
    -(b - (b^2 - 4*a*c)^(1/2))/(2*a)
    ~~~

    > 注意：solve()函数求解方程时，所得到的结果不一定准确。

- 常微分方程符号求解

  - 在MATLAB中，用大写字母D表示导数。例如，Dy表示y'，D2y表示y''，
    Dy(0)=5表示y'(0)=5。D3y+D2y+Dy-x+5=0表示微分方程y'''+y''+y'-x+5=0。

  - 符号常微分方程求解可以通过函数dsolve()函数来实现，其调用格式为：
                                     dsolve(e,c,v)

    用于求解常微分方程e在初值条件c下的特解。参数v是方程中的自变量，省
    略时按默认原则处理，若没有给出初值条件c，则求方程的通解。

  - dsolve在求常微分方程组时的调用格式为：

    dsolve(e1,e2,…,en,c1,c2,…,cn,v)

    用于求解常微分方程组e1, e2, …, en在初值条件c1, c2, …, cn下的特解，若不
    给出初值条件，则求方程组的通解。v给出求解变量，如果没有指定自变量，
    则采用默认自变量t。

  - 求下列微分方程或方程组的解。

    ~~~matlab
    >> syms x y t;
    >> y=dsolve('Dy-(x^2+y^2)/x^2/2',x)
    y =
    	x -x*(1/(C5 + log(x)/2) - 1)
    >> [x,y]=dsolve('Dx=4*x-2*y','Dy=2*x-y',t)
    x =
    	C8/2 + 2*C7*exp(3*t)
    y =
    	C8 + C7*exp(3*t)
    ~~~

## MATLAB图形用户界面设计

### 图形对象句柄

- 句柄的概念

  - 在MATLAB中，每一个具体的图形都是由若干个不同的图形对象组成的。
    在MATLAB中，用句柄来标识对象，通过句柄来访问相应对象的属性。

  - 绘制多个图形，并保存图形句柄。

    ~~~matlab
    t=0:pi/10:2*pi;
    h1=plot3(t+pi,t-2*pi,sin(t),'r'); %h1为保存图像句柄
    hold on;
    [x,y]=meshgrid(t);
    z=sin(x);
    h2=mesh(t-2*pi,t+pi,z);
    [x3,y3,z3]=cylinder(t);
    h3=surf(x3,y3,z3);
    ~~~
    
  - 访问图形对象
  
  访问图形对象是指获取或设置图形对象的属性。不同图形对象所具有的属
    性不同，但访问的方法是一样的。
  
    对象句柄.属性名
  
    ~~~matlab
    >> x=0:pi/10:2*pi;
    >> y=sin(x);
    >> h0=plot(x,y);
    >> h0.Color
    ans =
    0 0.4470 0.7410
    >> h0.LineWidth=2;
    >> h0.LineStyle='-.';
    ~~~
  
  - 获取特定图形对象句柄的函数
  
    - gcf：获取当前图形窗口的句柄。
    - gca：获取当前坐标轴的句柄。
    - gco：获取最近被选中的图形对象的句柄。
    - findobj：按照指定的属性来获取图形对象的句柄。
  
    ~~~matlab
    h1=gcf
    ~~~
  
- 图形对象属性

  - 图形对象的常用公共属性

    - Children属性：该对象的所有子对象的句柄组成的一个向量
    - Parent属性：该对象的父对象的句柄
    - Type属性：对象的类型，这是一个只读属性
    - Tag属性：用于给对象定义一个标识符

  - 例题：分别在两个子图中绘制曲线和曲面。然后设置子图1的背景色为黄
    色，曲线线条颜色为红色，设置子图2的背景色为青色。

    ~~~matlab
    subplot(1,2,1)
    h1=fplot(@(t)t.*sin(t),@(t)t.*cos(t),[0,6*pi] );
    axis equal
    subplot(1,2,2)
    [x,y,z]=peaks(20);
    h2=mesh(x,y,z);
    h10=h1.Parent;
    h10.Color='y';
    h1.Color='r';
    h2.Parent.Color='cyan';
    ~~~

  - 图形对象的常用动态属性

    - KeyPressFcn属性：定义按下键盘按键事件的响应
    - CreateFcn属性：定义创建图形对象时做出的响应
    - DeleteFcn属性：定义取消图形对象时做出的响应
    - WindowButtonDownFcn或ButtonDownFcn属性：定义鼠标键按下事件的响应

- 图形窗口的操作
  - 建立图形窗口对象

    > MATLAB通过figure函数来创建窗口对象，其调用格式为：

    - 句柄变量=figure(属性1,属性值1,属性2,属性值2,…)其中，属性用于设置图形窗口的特征。

    - 句柄变量=figure

      按MATLAB默认的属性值建立图形窗口。

    - figure(窗口句柄)
      设定该句柄对应的窗口为当前窗口。

  - 图形窗口属性
  
    - MenuBar属性：控制图形窗口是否具有菜单条，其取值为'none'或 'figure'。
    - Name属性：指定图形窗口的标题。
    - NumberTitle属性：决定着在图形窗口的标题中是否以“Figure n：”为标题前缀。
    - Color属性：设定图形窗口背景的颜色。
    - Position属性：定义图形窗口对象在屏幕上的位置和大小，值是一
      个4元行向量：
      [x，y，w，h]
    - Units属性：定义图形窗口使用的度量单位，将影响一切定义大小的属性项。
      - 'pixels'：指定度量单位为像素（默认值）。
      -  'inches'：指定度量单位为英寸。厘米、磅。
      -  'centimeters'：指定度量单位为厘米。
      - 'points'：指定度量单位为磅。
      - 'normalized'：指定用相对单位。
  
  - 例3 建立一个图形窗口。该图形窗口没有菜单条，标题名称为“图
    形窗口示例”，起始于屏幕左下角、宽度和高度分别为300像素点和
    150像素点，背景颜色为青色，且当用户从键盘按下任意一个键时，然
    后在窗口中单击鼠标左键，在鼠标指针所在位置将显示
    “Hello,World!” 。
  
    ~~~matlab
    hf=figure;
    hf.Color=[0,1,1];
    hf.Position=[1,1,300,150];
    hf.Name='图形窗口示例';
    hf.NumberTitle='off';
    hf.MenuBar='none';
    hf.ButtonDownFcn='gtext(''Hello,World!'')';
    ~~~
  
- 坐标轴对象的操作

  - 建立坐标轴对象

    使用axes函数，其调用格式为：

    - 句柄变量=axes(属性1,属性值1,属性2,属性值2,…)
      其中，属性用于设置坐标轴的外观和行为。
    - 句柄变量=axes
      按MATLAB默认的属性值在当前图形窗口创建坐标轴。
    - axes(坐标轴句柄)
      设定该句柄代表的坐标轴为当前坐标轴。

  - 坐标轴对象的属性

    - Position属性：定义坐标轴在图形窗口中的位置和大小。
    - Units属性：定义坐标轴使用的度量单位，默认值是'normalized'。
    - Box属性：决定坐标轴是否带有边框，可取值是'on'或'off'（默认
      值）。
    - GridLineStyle属性：用于定义网格线的类型，可取值是':'（默认
      值）、'-'、'-. '、'--'、'none'。
    - Title属性：用于对坐标轴标题对象进行操作，取值是通过title函
      数建立的标题对象的句柄。
    - XLabel、YLabel、ZLabel属性：取值分别是通过xlabel、ylabel、
      zlabel函数建立的标签对象的句柄。
    - XLim、YLim、ZLim 属性：分别定义各坐标轴的下限和上限，取值
      是2元向量[Lmin, Lmax]，默认值为[0，1]。
    - XScale、YScale、ZScale 属性：定义各坐标轴的刻度类型。可取
      值是'linear'、'log'。
    - View属性：定义视点，取值是2元向量[az, el]，az定义视点的方
      位角，el定义视点的仰角。坐标轴默认视点的方位角为0°，仰角为
      90°。
    - ColorOrder属性：用于设置多条曲线的颜色顺序，是一个n×3矩阵，
      每行用RGB三元组表示一种颜色，默认n为7。

  - 利用坐标轴对象实现图形窗口的分割。

    ~~~matlab
    ha1=axes('Position',[0.1,0.1,0.7,0.7]);
    contour(peaks(20))
    ha1.Title=title('等高线');
    ha1.YLabel=ylabel('南北向');
    ha1.XLabel=xlabel('东西向');
    ha2=axes('Position',[0.65,0.7,0.28,0.28]);
    surf(peaks(20))
    ha2.View=[-30,45];
    ~~~

  - ColorOrder属性：用于设置多条曲线的颜色顺序，是一个n×3矩阵，
    每行用RGB三元组表示一种颜色，默认n为7。

    ~~~matlab
    >> hc=gca;
    >> C=hc.ColorOrder
    C =
    	0 0.4470 0.7410
    	0.8500 0.3250 0.0980
    	0.9290 0.6940 0.1250
    	0.4940 0.1840 0.5560
    	0.4660 0.6740 0.1880
    	0.3010 0.7450 0.9330
    	0.6350 0.0780 0.1840
    ~~~

  - 例5 定义包含4种颜色的ColorOrder属性，绘制6条曲线。

    ~~~matlab
    x=[0,0];y=[0,1];
    ha=axes;
    ha.ColorOrder=[0,0,0; 1,0,0; 0,1,0; 0,0,1];
    hold on
    plot(x,y,x+0.5,y,x+1,y,x+1.5,y,x+2,y,x+2.5,y);
    ha.XLim=[-0.2,3];
    ha.YLim=[-0.2,1.2];
    ~~~

    

### 曲线与曲面对象

- 曲线对象

  - 建立曲线对象

    line函数的调用格式为：
    句柄变量=line(x, y, z, 属性1, 属性值1, 属性2, 属性值2, …)
    其中，x、y、z存储数据点的坐标，与plot、plot3函数含义相同。

  - 曲线对象常用属性

    - Color属性：定义曲线的颜色，默认值为[0 0 0]。 
    - LineStyle属性：定义线型，默认值为'-'。 
    - LineWidth属性：定义线宽，默认值为0.5磅。
    - Marker属性：定义数据点标记符号，默认值为'none'。 
    - MarkerSize属性：定义数据点标记符号的大小，默认值为6磅。
    - XData、YData、ZData属性：用于设置3个坐标轴的数据源。

  - 例1 利用曲线对象绘制五环图案。

    ~~~matlab
    t=-0.1 : 0.1 : 2*pi;
    x=cos(t); y=sin(t);
    line(x,y,'Color','b')
    line(x+1.2,y-1,'Color','y')
    line(x+2.4,y,'Color','k')
    line(x+3.6,y-1,'Color','g')
    line(x+4.8,y,'Color','r')
    ha=gca;
    for n=1:size(ha.Children)
    ha.Children(n).LineWidth=5;
    end
    ha.XLim=[-2,7];
    ha.YLim=[-3,2];
    axis equal
    ~~~

- 曲面对象

  - 建立曲面对象
         建立曲面对象使用surface函数，其调用格式为：
    句柄变量=surface(x,y,z,c,属性1,属性值1,属性2,属性值2,…)
         其中，x、y、z存储数据点的坐标，与mesh、surf函数含义相同；c用
    于指定在不同高度下的曲面颜色。
         surf函数每调用一次，就会刷新坐标轴，清空原有图形，再绘制新的
    图形。而surface函数生成的曲面则在已有图形上叠加显示。
    利用surface函数建立的曲面对象，默认视点在图形正上方，即方位角
    为0°，仰角为90°。
    
  - 与曲面形态有关的属性：
    - FaceColor属性：定义曲面网格片的颜色，可取值：
      - 'flat'：每一个网格片用单一颜色填充。
      - 'interp'：用渐变方式填充网格片。
      - 'none'：网格片无颜色。
      - 'texturemap'：用Cdata属性定义的颜色填充网格片。
      - RGB向量或代表颜色的字符
    - EdgeColor属性：定义曲面网格线的颜色。
    
  - 例题 利用曲面对象绘制立体圆环，圆环方程为:
  
     ~~~matlab
     r=linspace(0,2*pi,60);
     [u,v]=meshgrid(r);
     x=(8+3*cos(v)).*cos(u);
     y=(8+3*cos(v)).*sin(u);
     z=3*sin(v);
     axes('view',[-37.5,30])
     hs=surface(x,y,z);
     axis equal;
     hs.EdgeColor='none';
     hs.FaceColor='interp';
     ~~~
  
- 光照处理

  - 创建光源对象
        light函数的调用格式为：
    对象句柄=light(属性1,属性值1,属性2,属性值2,…)
        其中，属性指定光源的特性。

  - 光源对象的属性

    - Color属性：设置光的颜色。
    - Style属性：设置光源类型，其取值为‘ infinite’（默认值）或' local'。  Position属性：指定光源位置，值是一个3元向量。

  - 设置光照模式
    利用lighting命令可以设置光照模式，lighting命令格式为：
    lighting 选项
    其中，选项可取值为

    - flat：使得入射光均匀洒落在图形对象的每个面上（默认值）。
    - gouraud：先对顶点颜色插补，再对顶点勾画的面上颜色进行插补。
    - phong：对顶点处的法线插值，再计算各个像素的反光。
    - none：关闭所有光源。

  - 例3 绘制光照处理后的圆环面并观察不同光照模式下的效果。

    ~~~matlab
    r=linspace(0,2*pi,60); [u,v]=meshgrid(r);
    x=(8+3*cos(v)).*cos(u); y=(8+3*cos(v)).*sin(u); z=3*sin(v);
    axes('Position',[0.05,0.675,1.0,0.3], 'View',[-37.5,30]);
    hs1=surface(x,y,z); axis equal;
    hs1.EdgeColor='none'; hs1.FaceColor='interp';
    axes('Position',[0.05,0.35,1.0,0.3], 'View',[-37.5,30]);
    hs2=surface(x,y,z); axis equal;
    hs2.EdgeColor='none'; hs2.FaceColor='interp';
    light('Position',[0,0,8])
    lighting flat
    axes('Position',[0.05,0.025,1.0,0.3], 'View',[-37.5,30]);
    hs3=surface(x,y,z); axis equal;
    hs3.EdgeColor='none'; hs3.FaceColor='interp';
    light('Position',[0,0,8])
    lighting phong
    ~~~

- 图形对象的反射特性

  - SpecularStrength属性：控制对象表面镜面反射的强度，属性值取
    0~1之间的数，默认为0.9。

  - DiffuseStrength 属性：控制对象表面漫反射的强度，属性值取0~1
    之间的数，默认为0.6。

  - AmbientStrength属性：确定环境光的强度，属性值取0~1之间的数
    ，默认为0.3。

  - SpecularExponent属性：控制镜面反射指数，值大于等于1，大多设
    置在[5 20]之间，默认为10。

  - BackFaceLighting属性：控制对象内表面和外表面的差别，取值为

    - 'unlit'
    - 'lit'
    - 'reverselit'（默认值）

  - 例4 绘制具有不同反射特性的圆环面并观察反射特性对图形效果的影响。

    ~~~matlab
    r=linspace(0,2*pi,60); [u,v]=meshgrid(r);
    x=(8+3*cos(v)).*cos(u); y=(8+3*cos(v)).*sin(u); z=3*sin(v);
    axes('Position',[0.05,0.675,1.0,0.3],'View',[-37.5,30]);
    hs1=surface(x,y,z);axis equal;
    hs1.EdgeColor='none';hs1.FaceColor='interp';
    light('Position',[0,0,8]) ;lighting phong
    hs1.SpecularStrength=0.1;
    axes('Position', [0.05,0.35,1.0,0.3],'View',[-37.5,30]);
    hs2=surface(x,y,z);axis equal;
    hs2.EdgeColor='none';hs2.FaceColor='interp';
    light('Position',[0,0,8]) ;lighting phong
    hs2.SpecularStrength=0.5;
    axes('Position', [0.05,0.025,1.0,0.3],'View',[-37.5,30]);
    hs3=surface(x,y,z);axis equal;
    hs3.EdgeColor='none';hs3.FaceColor='interp';
    light('Position',[0,0,8]) ;lighting phong ;
    hs3.SpecularStrength=1.0;
    ~~~


### 图形用户界面设计方法

- 图形用户界面的组成

  - 图形用户界面（Graphical User Interface，GUI）：用户与计算
    机进行信息交流的窗口。
  - 设计图形用户界面的方法
    - 调用建立用户界面控件的函数
    - 使用MATLAB提供的GUIDE工具进行可视化设计

- 控件对象及其操作

  - 常用控件

    - 输入和输出类控件：编辑框、静态文本、列表框、滑动条等
    - 实施确认、选择操作类控件：按钮、双位按钮、单选按钮、复选框等

  - 建立控件对象

    - ​		函数uicontrol用于建立控件对象，其调用格式为：
      句柄变量=uicontrol(图形窗口句柄,属性1,属性值1,属性2,属性值2,…)
      ​		其中，属性及其取值决定了控件的特征。若省略图形窗口句柄，默认
      在当前图形窗口建立控件对象

  - 控件对象的基本控制属性

    - Style属性：定义控件对象的类型，例如‘pushbutton’表示按钮对
      象，'edit'表示编辑框，等等
    - String属性：定义控件对象的说明文字
    - Tag属性：标识控件对象
    - Enable属性：控制控件对象是否可用
    - Position属性：定义控件对象的位置，其取值形式为[x，y，w，h]
    - Callback属性：其属性值是描述命令的字符串或函数句柄，当选中控
      件时，系统将自动执行字符串描述的命令或调用句柄所代表的函数，
      实施相关操作

  - 例1 在图形窗口中建立三个按钮对象，当单击按钮时分别绘制正弦曲
    线、显示或隐藏坐标轴的网格、清除坐标轴的图形

    ~~~matlab
    ha= axes('Units','pixels','Position',[40,40,360,360]); 
    ptgrid=uicontrol('Style','pushbutton',...
    'String','网格', 'Position', [450,120,48,20],...
    'Callback','grid' );
    btncla = uicontrol('Style', 'pushbutton', ...
    'String', '清除','Position', [450,80,48,20],...
    'Callback','cla' ); 
    btnplot = uicontrol('Style', 'pushbutton', ...
    'String','绘图','Position', [450,160,48,20]);
    ~~~

    >回调函数定义对象怎样处理信息并响应某事件。回调函数的定义格式：
    >function 函数名(source, eventdata)
    >……
    >end
    >其中，参数source是发生事件的源控件对象句柄，eventdata存储事件
    >数据。
    >例如，将例1的“绘图”按钮要实现的功能定义为回调函数plot_sin

    ~~~matlab
    function plot_sin(source, callbackdata)
    	t=-pi:pi/20:pi;
    	plot(t,sin(t));
    end
    ~~~

    ---

    ~~~matlab
    ha= axes('Units','pixels','Position',[40,40,360,360]); 
    ptgrid=uicontrol('Style','pushbutton',...
    'String','网格', 'Position', [450,120,48,20],...
    'Callback','grid' );
    btncla = uicontrol('Style', 'pushbutton', ...
    'String', '清除','Position', [450,80,48,20],...
    'Callback','cla' ); 
    btnplot = uicontrol('Style', 'pushbutton', ...
    'String','绘图','Position', [450,160,48,20]); 
    %设置“绘图”按钮的Callback属性值是plot_sin函数句柄。
    btnplot.Callback=@plot_sin;
    ~~~

- 菜单对象

  - 建立菜单对象

    uimenu函数用于创建、设置、修改菜单

    - 建立一级菜单项的函数调用格式为：

    一级菜单项句柄=uimenu(图形窗口句柄,属性,属性值1,属性2,属性值2,…)

    - 建立子菜单项的函数调用格式为：

    子菜单项句柄=uimenu(上级菜单项句柄,属性1,属性值1,属性2,属性值2,…)

  - 菜单属性

    - Label属性：定义菜单项的名字
    - Accelerator属性：定义菜单项的快捷键
    - Checked属性：指示菜单项是否已选中
    - Enable属性：控制菜单项的可选择性
    - Separator属性：在菜单项上方添加一条分隔线

    ---

    - 例2 在例1的界面中添加“图形选项”菜单项，其中包括一个二级菜
      单项“线型”，其下又有3个子菜单项，分别为“实线”、“虚线”、
      “双划线”。

      ~~~matlab
      hopt=uimenu(gcf,'Label','图形选项','Accelerator','L');
      hLStyle=uimenu(hopt,'Label','线型','Tag','LStyle', 
      'Enable','off');
      hL_Solid=uimenu(hLStyle,'Label','实线',...
      'Tag','Solid','Callback', @MLine_Type);
      hL_Dotted=uimenu(hLStyle,'Label','虚线',...
      'Tag','Dotted','Callback', @MLine_Type);
      hL_Dashed=uimenu(hLStyle,'Label','双划线',...
      'Tag','Dashed','Callback', @MLine_Type);
      ~~~

      新建函数文件MLine_Type.m，内容如下：

      ~~~matlab
      function MLine_Type(source,callbackdata)
      	hline=findobj('Type','line');
      	if strcmp(source.Tag,'Solid' )==1
      		hline.LineStyle='-';
      	elseif strcmp(source.Tag,'Dotted' )==1
      		hline.LineStyle=':'; 
      	elseif strcmp(source.Tag,'Dashed' )==1
      		hline.LineStyle='--'; 
      	end
      end
      ~~~

      修改函数文件plot_sin.m，内容如下：

      ~~~matlab
      function plot_sin(source, callbackdata)
      	t=-pi:pi/20:pi;
      	plot(t,sin(t));
      	h1=findobj('Tag','LStyle');
      	h1.Enable='On'; %使得 “线型”菜单项可用
      end
      ~~~

      ---

      程序的运行结果。
      首先运行例1的程序生成图形界面，再
      运行例2程序，在界面中添加“图形选
      项”菜单项，这时“线型”菜单项不
      可用，单击“绘图”按钮绘制正弦函
      数曲线后“线型”菜单项变为可用，
      这时可以改变线型，例如双划线，这
      时界面如图所示。

### 用户界面设计工具(ppt8.4)

- 图形用户界面设计窗口

  - 打开GUIDE
    - 在MATLAB命令行窗口输入guide命令。
    - 在MATLAB主窗口中选择“主页”选项卡，单击工具栏的“新建”命令按
      钮，再选择“应用程序”下的GUIDE命令。
  - 图形用户界面设计模板
    - Blank GUI (Default)
    - GUI with Uicontrols
    - GUI with Axes and Menu
    - Modal Question Dialog

- 回调属性与回调函数

  - 回调函数框架
    function 对象标识_Callback(hObject, eventdata, handles)
    其中，hObject为发生事件的源控件，eventdata为事件数据，handles保
    存图形界面中所有对象的句柄。

  ---

  - 回调函数举例
  - “绘图”按钮的Callback函数

  ~~~matlab
  function pushbutton1_Callback(hObject, eventdata, handles)
  	A=eval(handles.editfz.String);
  	f=eval(handles.editpl.String)/50;
  	theta=eval(handles.editxj.String)/180*pi;
  	x=linspace(0,2*pi,60);
  if handles.OpSin.Value==1
  	y=A*sin(f*x+theta);
  else
  	y=A*cos(f*x+theta);
  end
  plot(x,y);
  handles.PStyle.Enable='On';
  ~~~
  - “实线”菜单项的回调函数

  ~~~matlab
  function Solid_Callback(hObject, eventdata, handles)
  	hline=findobj('Type','line');
  	hline.LineStyle='-';
  	handles.Solid.Checked='On';
  	handles.Dotted.Checked='Off';
  	handles.Dashed.Checked='Off';
  ~~~

  - “红”菜单项的回调函数

  ~~~matlab
  function r_Callback(hObject, eventdata, handles)
  	hline=findobj('Type','line');
  	hline.Color='r';
  	handles.r.Checked='On';
  	handles.g.Checked='Off';
  	handles.b.Checked='Off';
  ~~~

  

